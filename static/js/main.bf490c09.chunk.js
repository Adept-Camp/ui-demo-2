(this.webpackJsonpsav3=this.webpackJsonpsav3||[]).push([[0],{1069:function(e,t){},1113:function(e,t){},1292:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(0),s=n(41),c=n.n(s),i=n(21),o=n(56),u=n(1357),l=n(1329),p=n(83),d=n(12),f=n(1340),b=n(1296),h=n(1342),j=n(1343),v=n(250),x=n.n(v),g=n(254),O=n.n(g),m=n(169),y=n.n(m),w=n(251),C=n.n(w),k=n(253),S=n.n(k),I=n(252),P=n.n(I),F=n(1341),R=n(1359),N=n(255),B=n.n(N),U=n(1344),D=n(38),T=n(204),W=n.n(T),A=function(e){return W()({},E,e)},E=A({Follow:function(){return"Follow"},Unfollow:function(){return"Unfollow"},"Edit profile":function(){return"Edit profile"},"Display name":function(){return"Display name"},Description:function(){return"Description"},"Thumbnail URL":function(){return"Thumbnail URL"},"Banner URL":function(){return"Banner URL"},Home:function(){return"Home"},Profile:function(){return"Profile"},Search:function(){return"Search"},"Search user ID":function(){return"Search user ID"},Peers:function(){return"Peers"},"Connected peers posts":function(){return"Connected peers posts"},Stats:function(){return"Stats"},"Connected peers stats":function(){return"Connected peers stats"},"Connecting to peers":function(){return"Connecting to peers"},Following:function(){return"Following"},"Not following anyone":function(){return"Not following anyone"},Export:function(){return"Export"},Import:function(){return"Import"},"Uncensorable content":function(){return"Uncensorable content"},Post:function(){return"Post"},"Copied to clipboard":function(){return"Copied to clipboard"},Share:function(){return"Share"},"URL expired":function(){return"URL expired"}}),L=n(170);Object(L.b)("es-MX",(function(e,t,n){return[["justo ahora","en un rato"],["hace %s segundos","en %s segundos"],["hace 1 minuto","en 1 minuto"],["hace %s minutos","en %s minutos"],["hace 1 hora","en 1 hora"],["hace %s horas","en %s horas"],["hace 1 d\xeda","en 1 d\xeda"],["hace %s d\xedas","en %s d\xedas"],["hace 1 semana","en 1 semana"],["hace %s semanas","en %s semanas"],["hace 1 mes","en 1 mes"],["hace %s meses","en %s meses"],["hace 1 a\xf1o","en 1 a\xf1o"],["hace %s a\xf1os","en %s a\xf1os"]][t]}));var M=A({Follow:function(){return"Seguir"},Unfollow:function(){return"Dejar de seguir"},"Edit profile":function(){return"Editar perfil"},"Display name":function(){return"Nombre para mostrar"},Description:function(){return"Descripci\xf3n"},"Thumbnail URL":function(){return"URL de miniatura"},"Banner URL":function(){return"URL del banner"},Home:function(){return"Casa"},Profile:function(){return"Perfil"},Search:function(){return"Buscar"},"Search user ID":function(){return"Buscar ID de usuario"},Peers:function(){return"Compa\xf1eros"},"Connected peers posts":function(){return"Publicaciones de compa\xf1eros conectados"},Stats:function(){return"Estadisticas"},"Connected peers stats":function(){return"Estad\xedsticas de compa\xf1eros conectados"},"Connecting to peers":function(){return"Conectando con sus compa\xf1eros"},Following:function(){return"Siguiendo"},"Not following anyone":function(){return"No seguir a nadie"},Export:function(){return"Exportar"},Import:function(){return"Importar"},"Uncensorable content":function(){return"Contenido sin censura"},Post:function(){return"Publicaci\xf3n"}});Object(L.b)("hu",(function(e,t,n){return[["\xe9ppen most","\xe9ppen most"],["%s m\xe1sodperce","%s m\xe1sodpercen bel\xfcl"],["1 perce","1 percen bel\xfcl"],["%s perce","%s percen bel\xfcl"],["1 \xf3r\xe1ja","1 \xf3r\xe1n bel\xfcl"],["%s \xf3r\xe1ja","%s \xf3r\xe1n bel\xfcl"],["1 napja","1 napon bel\xfcl"],["%s napja","%s napon bel\xfcl"],["1 hete","1 h\xe9ten bel\xfcl"],["%s hete","%s h\xe9ten bel\xfcl"],["1 h\xf3napja","1 h\xf3napon bel\xfcl"],["%s h\xf3napja","%s h\xf3napon bel\xfcl"],["1 \xe9ve","1 \xe9ven bel\xfcl"],["%s \xe9ve","%s \xe9ven bel\xfcl"]][t]}));var z=A({Follow:function(){return"K\xf6vet\xe9s"},Unfollow:function(){return"K\xf6vet\xe9s megsz\xfcntet\xe9se"},"Edit profile":function(){return"Profil szerkeszt\xe9se"},"Display name":function(){return"L\xe1that\xf3 n\xe9v"},Description:function(){return"Le\xedr\xe1s"},"Thumbnail URL":function(){return"Profilk\xe9p URL"},"Banner URL":function(){return"Banner URL"},Home:function(){return"Home"},Profile:function(){return"Profil"},Search:function(){return"Keres\xe9s"},"Search user ID":function(){return"Felhaszn\xe1l\xf3 ID keres\xe9se"},Peers:function(){return"Kapcsolatok"},"Connected peers posts":function(){return"Kapcsolatok \xfczenetei"},Stats:function(){return"Statisztik\xe1k"},"Connected peers stats":function(){return"Kapcsolatok statisztik\xe1i"},"Connecting to peers":function(){return"Kapcsol\xf3d\xe1s"},Following:function(){return"K\xf6vet\xe9sek"},"Not following anyone":function(){return"Nem k\xf6vet senkit"},Export:function(){return"Export\xe1l\xe1s"},Import:function(){return"Import\xe1l\xe1s"},"Uncensorable content":function(){return"Cenz\xfar\xe1zhatatlan tartalom"}}),K={"en-US":E,"es-MX":M,hu:z};Object.freeze(K);var J=K,_=Object(a.createContext)({languageCode:"en-US",setLanguageCode:null}),H=function(e){var t="en-US",n=window.navigator.language,s=localStorage.getItem("languageCode")||n||t;J[s]||(console.warn("no available translation for '".concat(s,"'")),s=t);var c=Object(a.useState)(s),i=Object(d.a)(c,2),o=i[0],u=i[1],l={languageCode:o,setLanguageCode:function(e){J[e]?(localStorage.setItem("languageCode",e),u(e)):console.warn("no available translation for '".concat(e,"'"))}},p=e.children;return Object(r.jsx)(_.Provider,{value:l,children:p})},q=function(){var e=Object(a.useContext)(_).languageCode;return J[e]},V=n(1),G=n.n(V),Z=n(8),Q=n(1361),X=n(35),$=n(28),Y=n(120),ee=n(93),te=n(241),ne=n(257),re=n(354),ae=n.n(re),se=n(544),ce=n(11),ie=n.n(ce),oe=n(171),ue=n(166),le=n.n(ue),pe=function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=r.name,s=r.maxSize;ie()("string"===typeof a,"invalid idb lru cache '".concat(a,"' not a string")),ie()("number"===typeof s,"invalid idb lru maxSize '".concat(s,"' not a number"));var c=!1,i=function(){var r=Object(Z.a)(G.a.mark((function r(){var s,i,o,u;return G.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return s=oe.createInstance({name:a}),i=oe.createInstance({name:"_".concat(a)}),r.next=4,s.length();case 4:return o=r.sent,r.next=7,i.length();case 7:u=r.sent,o>u?(t=s,e=i,n=o):(t=i,e=s,n=u),c=!0;case 10:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();i();var o=function(){var e=Object(Z.a)(G.a.mark((function e(){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!c){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,le()(10);case 4:return e.next=6,o();case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function u(e,t){return l.apply(this,arguments)}function l(){return(l=Object(Z.a)(G.a.mark((function r(a,c){var i;return G.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,e.setItem(a,c);case 2:if(!(++n>=s)){r.next=11;break}return n=0,i=t,t=e,e=i,r.next=11,e.clear();case 11:case"end":return r.stop()}}),r)})))).apply(this,arguments)}return{has:function(){var n=Object(Z.a)(G.a.mark((function n(r){var a,s;return G.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o();case 2:return n.next=4,e.getItem(r);case 4:return a=n.sent,n.next=7,t.getItem(r);case 7:return s=n.sent,n.abrupt("return",null!==a&&void 0!==a||null!==s&&void 0!==s);case 9:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),remove:function(){var n=Object(Z.a)(G.a.mark((function n(r){return G.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o();case 2:return n.next=4,e.removeItem(r);case 4:return n.next=6,t.removeItem(r);case 6:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),get:function(){var n=Object(Z.a)(G.a.mark((function n(r){var a,s,c;return G.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o();case 2:return n.next=4,e.getItem(r);case 4:return a=n.sent,n.next=7,t.getItem(r);case 7:if(s=n.sent,null===(c=a)||void 0===a){n.next=11;break}return n.abrupt("return",c);case 11:if(null===(c=s)||void 0===(c=s)){n.next=15;break}return n.next=14,u(r,c);case 14:return n.abrupt("return",c);case 15:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),set:function(){var t=Object(Z.a)(G.a.mark((function t(n,r){var a;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,o();case 2:return t.next=4,e.getItem(n);case 4:if(null===(a=t.sent)||void 0===a){t.next=10;break}return t.next=8,e.setItem(n,r);case 8:t.next=12;break;case 10:return t.next=12,u(n,r);case 12:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),clear:function(){var n=Object(Z.a)(G.a.mark((function n(){return G.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,o();case 2:return n.next=4,e.clear();case 4:return n.next=6,t.clear();case 6:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()}};window.IdbLru=pe;var de=pe,fe=de({name:"sdpCache",maxSize:2e3}),be=function(e){return function(){var t=Object(Z.a)(G.a.mark((function t(n,r){var a,s;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(n,r);case 2:return a=t.sent,s=n.getPeerId(),fe.set(s,a._pc.remoteDescription.sdp),t.abrupt("return",a);case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}()},he=function(e){return function(){var t=Object(Z.a)(G.a.mark((function t(n){var r,a;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e(n);case 2:return r=t.sent,a=r.remotePeer.toB58String(),fe.set(a,n.conn._pc.remoteDescription.sdp),t.abrupt("return",r);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},je=function(){var e=Object(Z.a)(G.a.mark((function e(t){var n,r,a;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ie()(t&&"string"===typeof t,"invalid peer id ".concat(t)),e.next=3,fe.get(t);case 3:return n=e.sent,ie()(n,"no sdp cache for peer id '".concat(t,"'")),r=se.parse(n),a={ip:r.media[0].connection.ip,port:r.media[0].port,protocol:r.media[0].protocol},e.abrupt("return",a);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),ve={withWebRtcSdpCache:function(e){var t=e.libp2p.transportManager._transports.get("WebRTCStar")._connect;t=t.bind(e.libp2p.transportManager._transports.get("WebRTCStar")),e.libp2p.transportManager._transports.get("WebRTCStar")._connect=be(t);var n=e.libp2p.transportManager._transports.get("WebRTCStar")._upgrader.upgradeInbound;return n=n.bind(e.libp2p.transportManager._transports.get("WebRTCStar")._upgrader),e.libp2p.transportManager._transports.get("WebRTCStar")._upgrader.upgradeInbound=he(n),e},sdpCache:fe,getWebRtcPeerConnectionInfo:je},xe=n(244),ge=new(n.n(xe).a)({maxSize:1e3}),Oe=function(e){return function(t,n,r){if(!1===r){var a=t,s=n.cid.toString();ge.set(a,s)}return e(t,n,r)}},me=function(e){var t=e.ipld.bs._bitswap._updateReceiveCounters;return t=t.bind(e.ipld.bs._bitswap),e.ipld.bs._bitswap._updateReceiveCounters=Oe(t),e},ye=n(26),we=n.n(ye),Ce=n(545),ke=n(40),Se=n.n(ke),Ie=n(53),Pe=n.n(Ie),Fe=n(82),Re=n.n(Fe),Ne=n(65),Be=["https://i.imgur.com/iKxWt1c.jpg","https://i.imgur.com/iD4bp6Mb.jpg","https://i.imgur.com/65kSbHTb.jpg","https://i.imgur.com/tNsOG3Bb.jpg","https://i.imgur.com/qiQHwHbb.jpg","https://i.imgur.com/txRRZpd.jpeg"],Ue=["https://i.imgur.com/ImQWjja.jpeg","https://i.imgur.com/txRRZpd.jpeg","https://i.imgur.com/2LwSsSu.gif","https://i.imgur.com/gpKZaRK.jpeg"],De=["https://i.imgur.com/qiQHwHb.mp4","i.imgur.com/ImQWjja.jpeg","http://i.imgur.com/txRRZpd.jpeg","https://i.imgur.com/2LwSsSu.gif","i.imgur.com/gpKZaRK.jpeg"],Te=["Jimmy Nguyen","Shadders","WallStreet5","Joshua Henslee","John M"],We=["Founder and CEO of XYZ.  Architect of the XYZ Protocol","I like Networks & Social Paradigm Shifts.","Spanish IT Raspberry Pi 4 + Python #BigData #Hacking #Cybersecurity #IoT #IPv6","U mad bro?","Praesentpellentesquetellussitametnuncfaucibus,sitametconvallissemporta.Sedmetudui,luctusavolutpatid,malesuadaadui."],Ae=["https://mystartup.com","mystartup.com","https://twitter.com/crypto","https://t.me/sav3org"],Ee=["Lorem ipsum dolor sit amet, consectetur adipiscing elit.","Duis turpis nibh, feugiat gravida venenatis vitae, eleifend eu enim. Ut in luctus lorem. Vivamus lectus nunc, cursus eget eleifend ut, luctus et nibh.","Suspendisse","Praesent pellentesque tellus sit amet nunc faucibus, sit amet convallis sem porta. Sed metus dui, luctus a volutpat id, malesuada a dui.","https://verylonglink.com/veryveryveryveryveryveryveryveryveryvery-long-link Praesent pellentesque tellus sit amet nunc faucibus, sit amet convallis sem porta. Sed metus dui, luctus a volutpat id, malesuada a dui","Nullam egestas eget augue id dapibus","Praesentpellentesquetellussitametnuncfaucibus,sitametconvallissemporta.Sedmetudui,luctusavolutpatid,malesuadaadui."],Le=0,Me=function(e){var t=Math.floor(Math.random()*e.length);return t+=Le++,e[t%=e.length]},ze=function(e){window.sav3IpfsTest={},window.sav3IpfsTest.add=Object(Z.a)(G.a.mark((function t(){var n,r;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n={content:"hello world "+Math.random()},t.next=3,e.ipfs.add(n);case 3:r=t.sent,console.log(r);case 5:case"end":return t.stop()}}),t)}))),window.sav3IpfsTest.get=function(){var t=Object(Z.a)(G.a.mark((function t(n){var r,a,s,c,i,o,u,l,p,d,f,b,h,j,v;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=!0,a=!1,t.prev=2,c=Object(Ne.a)(e.ipfs.get(n));case 4:return t.next=6,c.next();case 6:return i=t.sent,r=i.done,t.next=10,i.value;case 10:if(o=t.sent,r){t.next=54;break}if(u=o,console.log(u.path),u.content){t.next=16;break}return t.abrupt("continue",51);case 16:l=[],p=!0,d=!1,t.prev=19,b=Object(Ne.a)(u.content);case 21:return t.next=23,b.next();case 23:return h=t.sent,p=h.done,t.next=27,h.value;case 27:if(j=t.sent,p){t.next=34;break}v=j,l.push(v);case 31:p=!0,t.next=21;break;case 34:t.next=40;break;case 36:t.prev=36,t.t0=t.catch(19),d=!0,f=t.t0;case 40:if(t.prev=40,t.prev=41,p||null==b.return){t.next=45;break}return t.next=45,b.return();case 45:if(t.prev=45,!d){t.next=48;break}throw f;case 48:return t.finish(45);case 49:return t.finish(40);case 50:console.log(l.toString());case 51:r=!0,t.next=4;break;case 54:t.next=60;break;case 56:t.prev=56,t.t1=t.catch(2),a=!0,s=t.t1;case 60:if(t.prev=60,t.prev=61,r||null==c.return){t.next=65;break}return t.next=65,c.return();case 65:if(t.prev=65,!a){t.next=68;break}throw s;case 68:return t.finish(65);case 69:return t.finish(60);case 70:case"end":return t.stop()}}),t,null,[[2,56,60,70],[19,36,40,50],[41,,45,49],[61,,65,69]])})));return function(e){return t.apply(this,arguments)}}(),window.sav3IpfsTest.addresses=Object(Z.a)(G.a.mark((function t(){var n,r,a,s,c;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ipfs.swarm.addrs();case 2:for(r in n=t.sent){a=Object($.a)(n[r].addrs);try{for(a.s();!(s=a.n()).done;)(c=s.value).string=c.toString()}catch(i){a.e(i)}finally{a.f()}}console.log(n);case 5:case"end":return t.stop()}}),t)}))),window.sav3IpfsTest.peers=Object(Z.a)(G.a.mark((function t(){var n,r,a,s;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.ipfs.swarm.peers();case 2:n=t.sent,r=Object($.a)(n);try{for(r.s();!(a=r.n()).done;)(s=a.value).addrString=s.addr.toString()}catch(c){r.e(c)}finally{r.f()}console.log(n);case 6:case"end":return t.stop()}}),t)}))),window.sav3IpfsTest.editProfile=Object(Z.a)(G.a.mark((function t(){var n;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=Math.random()>.5?Me(Ae):"",t.next=3,e.editUserProfile({displayName:Me(Te),description:"".concat(Me(We).substring(0,100)," ").concat(n),thumbnailUrl:Me(Be),bannerUrl:Me(Ue)});case 3:case"end":return t.stop()}}),t)}))),window.sav3IpfsTest.publishPosts=Object(Z.a)(G.a.mark((function t(){var n,r,a=arguments;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=a.length>0&&void 0!==a[0]?a[0]:5;case 1:if(!n--){t.next=7;break}return r=Math.random()>.5?Me(De):"",t.next=5,e.publishPost({content:"".concat(Me(Ee).substring(0,100)," ").concat(r)});case 5:t.next=1;break;case 7:case"end":return t.stop()}}),t)}))),window.sav3IpfsTest.editProfileAndPublishPosts=function(){var e=Object(Z.a)(G.a.mark((function e(t){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.sav3IpfsTest.editProfile();case 2:return e.next=4,window.sav3IpfsTest.publishPosts(t);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),window.sav3IpfsTest.importExport=function(){var t=Object(Z.a)(G.a.mark((function t(n){var r,a,s,c,i,o,u,l,p,d;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.waitForReady();case 2:return t.next=4,e.ipfs.id();case 4:return r=t.sent,a=r.id,s=r.publicKey,t.next=9,e.getOwnPeerCid();case 9:return c=t.sent,t.next=12,e.getPrivateKey();case 12:return i=t.sent,t.next=15,e.setPrivateKey(n||i);case 15:return t.next=17,e.waitForReady();case 17:return t.next=19,e.ipfs.id();case 19:return o=t.sent,u=o.id,l=o.publicKey,t.next=24,e.getOwnPeerCid();case 24:return p=t.sent,t.next=27,e.getPrivateKey();case 27:d=t.sent,console.log("oldCid",a),console.log("newCid",u),console.log("oldPeerCid",c),console.log("newPeerCid",p),console.log("oldPublicKey",s),console.log("newPublicKey",l),console.log("oldPrivateKey",i),console.log("newPrivateKey",d);case 36:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()},Ke=n(29),Je=n.n(Ke),_e=n(167),He=de({name:"postRepliesCache",maxSize:2e3}),qe=function(){var e=Object(Z.a)(G.a.mark((function e(){var t,n,r,a,s,c=arguments;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},n=t.cid,r=t.parentPostCid,ie()(n&&"string"===typeof n,"postRepliesUtils.cachePostReplyCid cid '".concat(n,"' not a string")),ie()(r&&"string"===typeof r,"postRepliesUtils.cachePostReplyCid parentPostCid '".concat(r,"' not a string")),e.next=5,He.get(r);case 5:return a=e.sent,s={},a&&(s=JSON.parse(a)),s[n]=!0,console.log("postRepliesUtils.cachePostReplyCid",{cid:n,parentPostCid:r,postRepliesCids:s,res:a}),e.next=12,He.set(r,JSON.stringify(s));case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ve=function(){var e=Object(Z.a)(G.a.mark((function e(t){var n,r;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ie()(t&&"string"===typeof t,"postRepliesUtils.getPostRepliesCids postCid '".concat(t,"' not a string")),e.next=3,He.get(t);case 3:return n=e.sent,r=[],n&&(r=Object.keys(JSON.parse(n))),console.log("postRepliesUtils.getPostRepliesCids",{postCid:t,postRepliesCids:r,res:n}),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ge={postRepliesCache:He,cachePostReplyCid:qe,getPostRepliesCids:Ve},Ze=new(function(e){Object(te.a)(n,e);var t=Object(ne.a)(n);function n(){var e;return Object(Y.a)(this,n),(e=t.call(this)).ipfs=null,e.ipnsClient=null,e._initIpfs().catch(console.log),e}return Object(ee.a)(n,[{key:"_initIpfs",value:function(){var e=Object(Z.a)(G.a.mark((function e(){var t,n,r,a,s=this,c=arguments;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:{},n=t.privateKey,r={preload:{enabled:!1},config:{Bootstrap:[],Addresses:{Delegates:[],Swarm:_e.a.starServers}}},n&&(r.config.Identity={PrivKey:n}),console.log("_initIpfs",{ipfsOptions:r}),e.next=7,ae.a.create(r);case 7:a=e.sent,this.ipfs=ve.withWebRtcSdpCache(a),this.ipfs=me(a),this.ipnsClient=Object(Ce.a)({ipfs:a}),this.ipnsClient.on("publish",(function(e,t){s.emit("publish",e,t)})),window.ipfs=this.ipfs,this.ipfs.libp2p.on("peer:discovery",(function(e){console.log("discovered",e)})),this.ipfs.libp2p.on("peer:connect",(function(e){console.log("connected",e),s.ipfs.swarm.peers().then((function(e){return console.log("current peers connected: ",e)}))})),this.setMaxListeners(100);case 16:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getPeersStats",value:function(){var e=Object(Z.a)(G.a.mark((function e(){var t,n,r,a,s;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return t=[],e.next=5,this.getPeersCids();case 5:n=e.sent,r=Object($.a)(n),e.prev=7,r.s();case 9:if((a=r.n()).done){e.next=18;break}return s=a.value,e.t0=t,e.next=14,this.getPeerStats(s);case 14:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 16:e.next=9;break;case 18:e.next=23;break;case 20:e.prev=20,e.t2=e.catch(7),r.e(e.t2);case 23:return e.prev=23,r.f(),e.finish(23);case 26:return console.log("getPeersStats",{peersStats:t}),e.abrupt("return",t);case 28:case"end":return e.stop()}}),e,this,[[7,20,23,26]])})));return function(){return e.apply(this,arguments)}}()},{key:"getPeerStats",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){var n,r,a,s,c,i,o,u,l;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return ie()("string"===typeof t,"sav3Ipfs.getPeerStats peerId '".concat(t,"' not a string")),n=this.ipfs.libp2p.metrics,e.prev=4,e.next=7,ve.getWebRtcPeerConnectionInfo(t);case 7:c=e.sent,r=c.ip,a=c.port,s=c.protocol,e.next=15;break;case 13:e.prev=13,e.t0=e.catch(4);case 15:return i=n.forPeer(we.a.createFromCID(t)).toJSON(),o=Number(i.dataReceived),u=Number(i.dataSent),l={peerCid:t,ip:r,port:a,protocol:s,dataReceived:o,dataSent:u},e.abrupt("return",l);case 20:case"end":return e.stop()}}),e,this,[[4,13]])})));return function(t){return e.apply(this,arguments)}}()},{key:"getPeersCids",value:function(){var e=Object(Z.a)(G.a.mark((function e(){var t,n,r,a,s,c,i;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return e.next=4,this.ipfs.swarm.peers();case 4:t=e.sent,n=new Set,r=[],a=Object($.a)(t),e.prev=8,a.s();case 10:if((s=a.n()).done){e.next=19;break}if(c=s.value,i=c.peer,!n.has(i)){e.next=15;break}return e.abrupt("continue",17);case 15:n.add(i),r.push(i);case 17:e.next=10;break;case 19:e.next=24;break;case 21:e.prev=21,e.t0=e.catch(8),a.e(e.t0);case 24:return e.prev=24,a.f(),e.finish(24);case 27:return e.abrupt("return",r);case 28:case"end":return e.stop()}}),e,this,[[8,21,24,27]])})));return function(){return e.apply(this,arguments)}}()},{key:"getPrivateKey",value:function(){var e=Object(Z.a)(G.a.mark((function e(){var t,n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return e.next=4,this.ipfs.key.export("self","password");case 4:return t=e.sent,e.next=7,Re.a.keys.import(t,"password");case 7:return n=e.sent,e.abrupt("return",Je()(n.bytes,"base64"));case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setPrivateKey",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){var n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ie()(t&&"string"===typeof t,"sav3Ipfs.setPrivateKey base64PrivateKey '".concat(t,"' not a string")),n=this.ipfs,delete this.ipfs,e.next=5,n.stop();case 5:return e.next=7,this._initIpfs({privateKey:t});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getOwnPeerCid",value:function(){var e=Object(Z.a)(G.a.mark((function e(){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return e.next=4,Ze.ipfs.id();case 4:return e.abrupt("return",e.sent.id);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getOwnUserCid",value:function(){var e=Object(Z.a)(G.a.mark((function e(){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return e.next=4,Ze.ipfs.id();case 4:return e.abrupt("return",e.sent.id);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getIpnsFile",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){var n,r;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return ie()(t&&"string"===typeof t,"sav3Ipfs.getIpnsFile ipnsCid '".concat(t,"' not a string")),e.next=5,this.ipfs.name.resolve(t).next();case 5:return n=e.sent.value,e.next=8,this.getIpfsFile(n);case 8:return r=e.sent,e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getOwnIpnsRecord",value:function(){var e=Object(Z.a)(G.a.mark((function e(){var t,n,r,a;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return e.next=4,Ze.getOwnPeerCid();case 4:return t=e.sent,n=we.a.createFromCID(t),e.next=8,this.ipfs.libp2p.datastore.get(Pe.a.getLocalKey(n.id));case 8:return r=e.sent,a=Pe.a.unmarshal(r),e.abrupt("return",a);case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"putOwnIpnsRecord",value:function(){var e=Object(Z.a)(G.a.mark((function e(){var t,n,r,a,s,c,i,o,u,l,p=arguments;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=p.length>0&&void 0!==p[0]?p[0]:{},n=t.value,r=t.sequence,e.next=3,this.waitForReady();case 3:return ie()(n&&"string"===typeof n,"sav3Ipfs.putOwnIpnsRecord value '".concat(n,"' not a string")),ie()("number"===typeof r,"sav3Ipfs.putOwnIpnsRecord sequence '".concat(r,"' not a number")),n.startsWith("/ipfs/")||(n="/ipfs/".concat(n)),a=31536e7,e.next=9,this.ipfs.key.export("self","password");case 9:return s=e.sent,e.next=12,Re.a.keys.import(s,"password");case 12:return c=e.sent,e.next=15,Pe.a.create(c,n,r,a);case 15:return i=e.sent,o=Pe.a.marshal(i),e.next=19,Ze.getOwnPeerCid();case 19:return u=e.sent,l=we.a.createFromCID(u),e.next=23,this.ipfs.libp2p.datastore.put(Pe.a.getLocalKey(l.id),o);case 23:return e.next=25,this.ipfs.name.resolve(u);case 25:return e.abrupt("return",i);case 26:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getIpfsFile",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){var n,r,a;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return ie()(t&&"string"===typeof t,"sav3Ipfs.getIpfsFile fileCid '".concat(t,"' not a string")),e.next=5,this.ipfs.get(t).next();case 5:if(!(n=e.sent.value).content){e.next=11;break}return e.next=9,n.content.next();case 9:a=e.sent,r=a&&a.value&&a.value.toString();case 11:return console.log("getIpfsFile",{fileCid:t,file:n,content:r}),e.abrupt("return",r);case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getOwnIpnsData",value:function(){var e=Object(Z.a)(G.a.mark((function e(){var t,n,r;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return e.next=4,this.getOwnIpnsRecord();case 4:return t=e.sent,n=t.value.toString(),e.next=8,this.getIpfsFile(n);case 8:if(r=e.sent,console.log("getOwnIpnsData",{ownIpfsValue:n,lastIpnsData:r}),r){e.next=12;break}return e.abrupt("return",{});case 12:return e.abrupt("return",JSON.parse(r));case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"subscribeToIpnsPath",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){var n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ie()(t&&"string"===typeof t,"sav3Ipfs.subscribeToIpnsPath ipnsPath '".concat(t,"' not a string")),e.next=3,this.waitForReady();case 3:return e.next=5,this.ipnsClient.subscribe([t]);case 5:return n=e.sent,e.abrupt("return",n[0]);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"subscribeToIpnsPaths",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){var n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ie()(Array.isArray(t),"sav3Ipfs.subscribeToIpnsPaths ipnsPaths '".concat(t,"' not an array")),e.next=3,this.waitForReady();case 3:return e.next=5,this.ipnsClient.subscribe(t);case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"publishPost",value:function(){var e=Object(Z.a)(G.a.mark((function e(){var t,n,r,a,s,c,i,o,u=arguments;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=u.length>0&&void 0!==u[0]?u[0]:{},n=t.content,r=t.parentPostCid,e.next=3,this.waitForReady();case 3:return ie()(n&&"string"===typeof n,"sav3Ipfs.publishPost content '".concat(n,"' not a string")),ie()(n.length<=140,"sav3Ipfs.publishPost content '".concat(n,"' longer than 140 chars")),ie()(!r||"string"===typeof r,"sav3Ipfs.publishPost parentPostCid '".concat(r,"' not a string")),e.next=8,this.getOwnIpnsData();case 8:return a=e.sent,(s={}).previousPostCid=a.lastPostCid,s.timestamp=Math.round(Date.now()/1e3),e.next=14,this.ipfs.id();case 14:return s.userCid=e.sent.id,e.next=17,this.ipfs.add(n);case 17:return s.contentCid=e.sent.cid.toString(),s.parentPostCid=r,e.next=21,this.ipfs.add(JSON.stringify(s));case 21:return c=e.sent.cid.toString(),i=Object(X.a)(Object(X.a)({},a),{},{lastPostCid:c}),e.next=25,this.ipfs.add(JSON.stringify(i));case 25:return o=e.sent.cid.toString(),e.next=28,this.publishIpnsRecord(o);case 28:if(console.log("publishPost",{newIpnsDataCid:o,newPost:s,newIpnsData:i,ipnsData:a,newPostCid:c,parentPostCid:r}),!r){e.next=32;break}return e.next=32,Ge.cachePostReplyCid({cid:c,parentPostCid:r});case 32:return e.abrupt("return",c);case 33:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"publishIpnsRecord",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){var n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return ie()("string"===typeof t,"sav3Ipfs.publishIpnsRecord '".concat(t,"' not a string")),e.next=5,this.getOwnIpnsRecordSequence();case 5:return e.t0=e.sent,n=e.t0+1,e.next=9,this.ipnsClient.publish({value:t,sequence:n});case 9:return e.next=11,this.putOwnIpnsRecord({value:t,sequence:n});case 11:console.log("publishIpnsRecord",{newIpnsDataCid:t,sequence:n});case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"editUserProfile",value:function(){var e=Object(Z.a)(G.a.mark((function e(){var t,n,r,a,s,c,i,o,u,l=arguments;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=l.length>0&&void 0!==l[0]?l[0]:{},n=t.displayName,r=t.description,a=t.thumbnailUrl,s=t.bannerUrl,e.next=3,this.waitForReady();case 3:if(c={},!n){e.next=10;break}return ie()("string"===typeof n,"display name not a string"),ie()(n.length<=50,"display name '".concat(n,"' longer than 50 chars")),e.next=9,this.ipfs.add(n);case 9:c.diplayNameCid=e.sent.cid.toString();case 10:if(!r){e.next=16;break}return ie()("string"===typeof r,"description not a string"),ie()(r.length<=140,"description '".concat(r,"' longer than 140 chars")),e.next=15,this.ipfs.add(r);case 15:c.descriptionCid=e.sent.cid.toString();case 16:if(!a){e.next=23;break}return ie()("string"===typeof a,"thumbnail url not a string"),ie()(a.startsWith("https://"),"thumbnail url '".concat(a,"' does not start with https://")),ie()(a.length<=140,"thumbnail url '".concat(a,"' longer than 140 chars")),e.next=22,this.ipfs.add(a);case 22:c.thumbnailUrlCid=e.sent.cid.toString();case 23:if(!s){e.next=30;break}return ie()("string"===typeof s,"banner url not a string"),ie()(s.startsWith("https://"),"banner url '".concat(s,"' does not start with https://")),ie()(s.length<=140,"banner url '".concat(a,"' longer than 140 chars")),e.next=29,this.ipfs.add(s);case 29:c.bannerUrlCid=e.sent.cid.toString();case 30:return e.next=32,this.ipfs.add(JSON.stringify(c));case 32:return i=e.sent.cid.toString(),e.next=35,this.getOwnIpnsData();case 35:return(o=e.sent).profileCid=i,e.next=39,this.ipfs.add(JSON.stringify(o));case 39:return u=e.sent.cid.toString(),e.next=42,this.publishIpnsRecord(u);case 42:return console.log("editProfile",{displayName:n,description:r,thumbnailUrl:a,bannerUrl:s,ipnsData:o,profile:c,profileCid:i,newIpnsDataCid:u}),e.abrupt("return",i);case 44:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUserProfile",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){var n,r;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return ie()("string"===typeof t,"sav3Ipfs.getUserProfile profileCid '".concat(t,"' not a string")),e.t0=JSON,e.next=6,this.getIpfsFile(t);case 6:if(e.t1=e.sent,n=e.t0.parse.call(e.t0,e.t1),r={},!n.diplayNameCid){e.next=13;break}return e.next=12,this.getIpfsFile(n.diplayNameCid);case 12:r.displayName=e.sent;case 13:if(!n.descriptionCid){e.next=17;break}return e.next=16,this.getIpfsFile(n.descriptionCid);case 16:r.description=e.sent;case 17:if(!n.thumbnailUrlCid){e.next=21;break}return e.next=20,this.getIpfsFile(n.thumbnailUrlCid);case 20:r.thumbnailUrl=e.sent;case 21:if(!n.bannerUrlCid){e.next=25;break}return e.next=24,this.getIpfsFile(n.bannerUrlCid);case 24:r.bannerUrl=e.sent;case 25:return console.log("getProfile",{profileCid:t,profileCids:n,profile:r}),e.abrupt("return",r);case 27:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getOwnIpnsRecordSequence",value:function(){var e=Object(Z.a)(G.a.mark((function e(){var t,n,r,a,s,c,i;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return e.next=4,this.getOwnIpnsRecord();case 4:return t=e.sent,n=t,e.next=8,Ze.getOwnPeerCid();case 8:return r=e.sent,e.next=11,this.ipnsClient.getRecords([r]);case 11:if(a=e.sent,s=Object(d.a)(a,1),c=s[0],i=c&&c.sequence||0,!(n>i)){e.next=19;break}return e.abrupt("return",n);case 19:return e.abrupt("return",i);case 20:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUserPostsFromLastPostCid",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){var n,r,a;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:ie()(t&&"string"===typeof t,"sav3Ipfs.getUserPostsFromLastPostCid lastPostCid '".concat(t,"' not a string")),n=[],r=5;case 5:if(t){e.next=8;break}return e.abrupt("break",17);case 8:if(!(n.length>=r)){e.next=10;break}return e.abrupt("break",17);case 10:return e.next=12,this.getPost(t);case 12:a=e.sent,t=a.previousPostCid,n.push(a),e.next=5;break;case 17:return console.log("getUserPostsFromLastPostCid",{lastPostCid:t,posts:n}),e.abrupt("return",n);case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPost",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){var n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return ie()(t&&"string"===typeof t,"sav3Ipfs.getPost postCid '".concat(t,"' not a string")),console.log("getPost",{postCid:t}),e.t0=JSON,e.next=7,this.getIpfsFile(t);case 7:if(e.t1=e.sent,(n=e.t0.parse.call(e.t0,e.t1)).cid=t,!n.parentPostCid){e.next=13;break}return e.next=13,Ge.cachePostReplyCid({cid:n.cid,parentPostCid:n.parentPostCid});case 13:return e.next=15,this.getIpfsFile(n.contentCid);case 15:return n.content=e.sent,console.log("getPost returns",{postCid:t,post:n}),e.abrupt("return",n);case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPostWithReplies",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){var n,r,a,s,c,i,o,u;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return ie()(t&&"string"===typeof t,"sav3Ipfs.getPostWithReplies postCid '".concat(t,"' not a string")),e.next=5,this.getPost(t);case 5:if(n=e.sent,r=n,!n.parentPostCid){e.next=11;break}return e.next=10,this.getPost(n.parentPostCid);case 10:r=e.sent;case 11:return e.next=13,this.getPostRepliesCids(n.cid);case 13:a=(a=e.sent).filter((function(e){return e!==t})),s=[],c=Object($.a)(a);try{for(c.s();!(i=c.n()).done;)o=i.value,s.push(this.getPost(o))}catch(l){c.e(l)}finally{c.f()}return e.next=20,Promise.all(s);case 20:return u=e.sent,n.parentPostCid&&u.shift(n),e.abrupt("return",Object(X.a)(Object(X.a)({},r),{},{replies:u}));case 23:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPostRepliesCids",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){var n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return ie()(t&&"string"===typeof t,"sav3Ipfs.getPostRepliesCids postCid '".concat(t,"' not a string")),e.next=5,Ge.getPostRepliesCids(t);case 5:return n=e.sent,e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getPostReplyCount",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){var n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.waitForReady();case 2:return ie()(t&&"string"===typeof t,"sav3Ipfs.getPostReplyCount postCid '".concat(t,"' not a string")),e.next=5,Ge.getPostRepliesCids(t);case 5:return n=e.sent,e.abrupt("return",n.length);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"isReady",value:function(){return!!this.ipfs}},{key:"waitForReady",value:function(){var e=Object(Z.a)(G.a.mark((function e(){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.ipfs){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,le()(10);case 4:return e.next=6,this.waitForReady();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),n}(Se.a));window.sav3Ipfs=Ze,window.Ipfs=ae.a,ze(Ze);var Qe=Ze,Xe=n(1360),$e=n(1332),Ye=n(1336),et=n(546),tt=n.n(et),nt=n(1334),rt=n(1335),at=n(1331),st=Object(l.a)((function(e){return{content:{paddingTop:0,paddingBottom:0,overflow:"hidden"}}}));var ct=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.open,n=e.onClose,a=e.content,s=e.actions,c=st(),i=Object(p.a)(),o=Object(at.a)(i.breakpoints.down("xs"));return Object(r.jsxs)($e.a,{fullScreen:o,fullWidth:!0,maxWidth:"xs",open:t,onClose:n,children:[Object(r.jsxs)(R.a,{alignItems:"center",display:"flex",px:2,height:i.sav3.topBar.height,children:[Object(r.jsx)(R.a,{flexGrow:1,children:Object(r.jsx)(nt.a,{onClick:n,children:Object(r.jsx)(tt.a,{})})}),o&&Object(r.jsx)(R.a,{px:1,children:s})]}),Object(r.jsx)(rt.a,{}),Object(r.jsx)(Ye.a,{className:c.content,children:a}),!o&&Object(r.jsxs)("div",{children:[Object(r.jsx)(rt.a,{}),Object(r.jsxs)(R.a,{alignItems:"center",display:"flex",px:3,height:i.sav3.topBar.height,children:[Object(r.jsx)(R.a,{flexGrow:1}),Object(r.jsx)(R.a,{children:s})]})]})]})},it=function(e){ie()(!e||"string"===typeof e,"invalid ipnsPath '".concat(JSON.stringify(e),"'"));var t=Object(a.useState)(),n=Object(d.a)(t,2),r=n[0],s=n[1];return console.log("useUserIpnsData",{ipnsPath:e,userIpnsData:r}),Object(a.useEffect)((function(){if(e){var t=function(){var t=Object(Z.a)(G.a.mark((function t(n,r){var a;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e===n){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,Qe.getIpfsFile(r);case 4:a=t.sent,s(JSON.parse(a));case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}();return Qe.on("publish",t),Object(Z.a)(G.a.mark((function t(){var n,r;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Qe.subscribeToIpnsPath(e);case 2:if(n=t.sent){t.next=6;break}return s(),t.abrupt("return");case 6:return t.next=8,Qe.getIpfsFile(n);case 8:r=t.sent,s(JSON.parse(r));case 10:case"end":return t.stop()}}),t)})))(),function(){Qe.off("publish",t)}}}),[e]),r},ot=function(e){ie()(!e||"string"===typeof e,"invalid userCid '".concat(JSON.stringify(e),"'"));var t={},n=Object(a.useState)(t),r=Object(d.a)(n,2),s=r[0],c=r[1],i=it(e),o=i&&i.profileCid;return console.log("useUserProfile",{userIpnsData:i,userCid:e,profileCid:o,userProfile:s}),Object(a.useEffect)((function(){o&&"string"===typeof o?Object(Z.a)(G.a.mark((function e(){var t;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe.getUserProfile(o);case 2:t=e.sent,c(t);case 4:case"end":return e.stop()}}),e)})))():c(t)}),[o]),s},ut=function(){var e=Object(a.useState)(),t=Object(d.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){Object(Z.a)(G.a.mark((function e(){var t;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe.getOwnUserCid();case 2:t=e.sent,r(t);case 4:case"end":return e.stop()}}),e)})))()}),[]),n},lt=n(1364),pt=n(107),dt=Object(l.a)((function(e){return{errorMessage:{overflow:"hidden"},content:{"& textarea":{overflow:"hidden"},"& fieldset":{border:"none"},marginBottom:e.spacing(1)},avatar:{marginTop:e.spacing(-.25),width:e.spacing(6),height:e.spacing(6),borderWidth:e.sav3.borderWidth,borderStyle:"solid",borderColor:e.sav3.borderColor},userCid:{wordBreak:"break-all"}}}));function ft(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.parentPost,n=dt();return Object(r.jsxs)(R.a,{display:"flex",children:[Object(r.jsx)(R.a,{pr:1,py:1.5,children:Object(r.jsx)(lt.a,{src:t.profile.thumbnailUrl,className:n.avatar})}),Object(r.jsxs)(R.a,{pt:1.5,pl:.5,flexGrow:1,children:[t.profile.displayName&&Object(r.jsx)(pt.a,{variant:"subtitle2",children:t.profile.displayName}),Object(r.jsx)(pt.a,{variant:"caption",color:"textSecondary",className:n.userCid,children:t.userCid}),Object(r.jsx)(pt.a,{variant:"body2",children:t.content})]})]})}var bt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.open,n=e.onClose,s=e.parentPost,c=q(),i=dt(),o=Object(a.useState)(""),u=Object(d.a)(o,2),l=u[0],p=u[1],f=Object(a.useState)(),b=Object(d.a)(f,2),h=b[0],j=b[1],v=ut(),x=ot(v),g=function(e){var t=e.target.value;try{t.length>140&&(t=t.subtring(0,140)),p(t)}catch(n){}},O=function(){var e=Object(Z.a)(G.a.mark((function e(){var t;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=s&&s.cid,e.prev=1,e.next=4,Qe.publishPost({content:l,parentPostCid:t});case 4:j(null),p(""),n(),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),j(e.t0.message);case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(){return e.apply(this,arguments)}}(),m=Object(r.jsxs)(a.Fragment,{children:[s&&Object(r.jsx)(ft,{parentPost:s}),Object(r.jsxs)(R.a,{display:"flex",children:[Object(r.jsx)(R.a,{pr:1,py:1.5,children:Object(r.jsx)(lt.a,{src:x.thumbnailUrl,className:i.avatar})}),Object(r.jsx)(Q.a,{autoFocus:!0,className:i.content,onChange:g,margin:"dense",id:"content",placeholder:c["Uncensorable content"](),fullWidth:!0,multiline:!0,rows:4,variant:"outlined",value:l}),h&&Object(r.jsx)(Xe.a,{classes:{message:i.errorMessage},severity:"error",children:h})]})]}),y=Object(r.jsx)("div",{children:Object(r.jsx)(F.a,{disableElevation:!0,variant:"contained",onClick:O,color:"primary",children:"SAV3"})});return Object(r.jsx)(ct,{onClose:n,open:t,content:m,actions:y})},ht=Object(l.a)((function(e){return{logo:{height:"1.1em"},logoButton:{height:"2.2em",width:"2.2em"},createTextButtonBox:Object(i.a)({},e.breakpoints.down("md"),{display:"none"}),createIconButtonBox:Object(i.a)({},e.breakpoints.up("lg"),{display:"none"}),createIconButton:{boxShadow:"none"},text:Object(i.a)({},e.breakpoints.down("md"),{display:"none"}),root:Object(i.a)({},e.breakpoints.up("lg"),{paddingLeft:e.spacing(2),paddingRight:e.spacing(2)})}}));function jt(){var e=ht(),t=Object(a.useState)(!1),n=Object(d.a)(t,2),s=n[0],c=n[1];return Object(r.jsxs)("div",{children:[Object(r.jsx)(R.a,{my:2,mx:1,alignItems:"center",display:"flex",className:e.createTextButtonBox,onClick:function(){return c(!0)},children:Object(r.jsx)(F.a,{fullWidth:!0,variant:"contained",size:"large",disableElevation:!0,children:"SAV3"})}),Object(r.jsx)(R.a,{my:2,pl:1,alignItems:"center",display:"flex",className:e.createIconButtonBox,onClick:function(){return c(!0)},children:Object(r.jsx)(U.a,{className:e.createIconButton,size:"medium",children:Object(r.jsx)(B.a,{})})}),Object(r.jsx)(bt,{open:s,onClose:function(){return c(!1)}})]})}var vt=function(){var e=ht(),t=q();return Object(r.jsx)("div",{className:e.root,children:Object(r.jsxs)(f.a,{children:[Object(r.jsxs)(b.a,{button:!0,component:D.b,to:"/",children:[Object(r.jsx)(h.a,{children:Object(r.jsx)(x.a,{fontSize:"large"})}),Object(r.jsx)(j.a,{primary:t.Home(),className:e.text})]}),Object(r.jsxs)(b.a,{button:!0,component:D.b,to:"/search",children:[Object(r.jsx)(h.a,{children:Object(r.jsx)(y.a,{fontSize:"large"})}),Object(r.jsx)(j.a,{primary:t.Search(),className:e.text})]}),Object(r.jsxs)(b.a,{button:!0,component:D.b,to:"/following",children:[Object(r.jsx)(h.a,{children:Object(r.jsx)(C.a,{fontSize:"large"})}),Object(r.jsx)(j.a,{primary:t.Following(),className:e.text})]}),Object(r.jsxs)(b.a,{button:!0,component:D.b,to:"/peers",children:[Object(r.jsx)(h.a,{children:Object(r.jsx)(P.a,{fontSize:"large"})}),Object(r.jsx)(j.a,{primary:t.Peers(),className:e.text})]}),Object(r.jsxs)(b.a,{button:!0,component:D.b,to:"/stats",children:[Object(r.jsx)(h.a,{children:Object(r.jsx)(S.a,{fontSize:"large"})}),Object(r.jsx)(j.a,{primary:t.Stats(),className:e.text})]}),Object(r.jsxs)(b.a,{button:!0,component:D.b,to:"/profile",children:[Object(r.jsx)(h.a,{children:Object(r.jsx)(O.a,{fontSize:"large"})}),Object(r.jsx)(j.a,{primary:t.Profile(),className:e.text})]}),Object(r.jsx)(jt,{})]})})},xt=n(1345),gt=n(1346),Ot=Object(l.a)((function(e){return{menu:{width:"100%",position:"fixed",bottom:0},createIconButtonBox:{right:e.spacing(4),bottom:e.spacing(8)},createIconButton:{}}}));function mt(){var e=Ot(),t=Object(a.useState)(!1),n=Object(d.a)(t,2),s=n[0],c=n[1];return Object(r.jsxs)(R.a,{position:"absolute",className:e.createIconButtonBox,children:[Object(r.jsx)(R.a,{my:2,pl:1,alignItems:"center",display:"flex",className:e.createIconButton,onClick:function(){return c(!0)},children:Object(r.jsx)(U.a,{className:e.createIconButton,size:"large",children:Object(r.jsx)(B.a,{})})}),Object(r.jsx)(bt,{open:s,onClose:function(){return c(!1)}})]})}var yt=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.className,n=Ot(),a=Object(o.i)("/:route"),s=a&&a.params&&a.params.route?a.params.route:"home";return Object(r.jsxs)(R.a,{className:t,children:[Object(r.jsxs)(xt.a,{value:s,className:n.menu,children:[Object(r.jsx)(mt,{}),Object(r.jsx)(gt.a,{component:D.b,to:"/",value:"home",icon:Object(r.jsx)(x.a,{})}),Object(r.jsx)(gt.a,{component:D.b,to:"/search",value:"search",icon:Object(r.jsx)(y.a,{})}),Object(r.jsx)(gt.a,{component:D.b,to:"/peers",value:"peers",icon:Object(r.jsx)(P.a,{})}),Object(r.jsx)(gt.a,{component:D.b,to:"/stats",value:"stats",icon:Object(r.jsx)(S.a,{})})]}),Object(r.jsx)(R.a,{width:0,className:"MuiBottomNavigation-root"})]})},wt=n(1347),Ct=n(552),kt=n(1363),St="rgb(127, 127, 127, 0.05)",It={breakpoints:{values:{xs:0,sm:682,md:960,lg:1280,xl:1920}},sav3:{layout:{columns:{left:{width:{md:275,sm:88,xs:68}},middle:{width:{md:600}},right:{width:{lg:350,md:290}}}},borderWidth:1,borderColor:St,topBar:{height:54},drawerMenu:{width:280},popoverMenu:{borderRadius:4}},palette:{divider:St},shape:{borderRadius:24},overrides:{MuiToolbar:{root:{minHeight:"".concat(54,"px!important")}},MuiDialog:{paper:{margin:0},paperFullWidth:{width:"100%"}},MuiSvgIcon:{fontSizeLarge:{fontSize:"1.8rem"}},MuiFab:{root:{boxShadow:"rgba(101, 119, 134, 0.2) 0px 0px 8px, rgba(101, 119, 134, 0.25) 0px 1px 3px 1px"}}}},Pt=function(e){var t=Object(Ct.a)(W()({},It,e));return t=Object(kt.a)(t)},Ft={Light:Pt(),Dark:Pt({palette:{type:"dark"}}),"SAV3 Light":Pt({palette:{primary:{light:"#7a7380",main:"#4e4854",dark:"#26212b"},secondary:{main:"#484854"}}})};Object.freeze(Ft);var Rt=Ft,Nt=Object(a.createContext)({theme:"Light",setTheme:null}),Bt=function(e){var t=Object(at.a)("(prefers-color-scheme: dark)")?"Dark":"Light",n=localStorage.getItem("muiTheme")||t;Rt[n]||(console.warn("no available theme for '".concat(n,"'")),n=t);var s=Object(a.useState)(n),c=Object(d.a)(s,2),i=c[0],o=c[1],u=Rt[i],l={theme:i,setTheme:function(e){Rt[e]?(localStorage.setItem("muiTheme",e),o(e)):console.warn("no available theme for '".concat(e,"'"))}},p=e.children;return Object(r.jsx)(Nt.Provider,{value:l,children:Object(r.jsx)(wt.a,{theme:u,children:p})})},Ut=n(1362),Dt=n(1348);var Tt=function(){var e=Object(a.useContext)(Nt),t=e.theme,n=e.setTheme,s=[];for(var c in Rt)s.push(Object(r.jsx)(Dt.a,{value:c,children:c},c));return Object(r.jsx)(Ut.a,{value:t,onChange:function(e){n(e.target.value)},label:"Theme",variant:"outlined",children:s})};var Wt=function(){var e=Object(a.useContext)(_),t=e.languageCode,n=e.setLanguageCode,s=[];for(var c in J)s.push(Object(r.jsx)(Dt.a,{value:c,children:c},c));return Object(r.jsx)(Ut.a,{value:t,onChange:function(e){n(e.target.value)},label:"Translation",variant:"outlined",children:s})},At=n(1349),Et=n(1350),Lt=Object(l.a)((function(e){var t;return{appBar:{backgroundColor:e.palette.background.default},appBarSticky:(t={position:"fixed",left:"auto",right:"auto"},Object(i.a)(t,e.breakpoints.up("xs"),{width:e.sav3.layout.columns.middle.width.md-2*e.sav3.borderWidth}),Object(i.a)(t,e.breakpoints.down("xs"),{width:"calc(100% - ".concat(2*e.sav3.borderWidth,"px)")}),t),appBarStickyAfter:{height:e.sav3.topBar.height+e.sav3.borderWidth}}}));var Mt=function(e){var t=e.children,n=Lt();return Object(r.jsxs)("div",{children:[Object(r.jsxs)(At.a,{position:"sticky",color:"transparent",elevation:0,classes:{positionSticky:n.appBarSticky},className:n.appBar,children:[Object(r.jsx)(Et.a,{disableGutters:!0,children:t}),Object(r.jsx)(rt.a,{})]}),Object(r.jsx)("div",{className:n.appBarStickyAfter})]})},zt=n(104),Kt=n.n(zt),Jt=n(1354),_t=n(1352),Ht=n(1353),qt=n(549),Vt=n.n(qt),Gt=n(256),Zt=n.n(Gt),Qt=n(548),Xt=n.n(Qt),$t=n(550),Yt=n.n($t),en=n(1351),tn=n(1368),nn=function(){return Object(a.useContext)(_).languageCode},rn=n(207),an=n.n(rn),sn=n(553),cn=n(205),on=n.n(cn),un=n(352),ln=n.n(un),pn=n(353),dn=n.n(pn),fn=n(20),bn=n.n(fn),hn=new(function(){function e(){Object(Y.a)(this,e),this.followingCache=oe.createInstance({name:"followingCache"}),this.blockedCache=oe.createInstance({name:"blockedCache"})}return Object(ee.a)(e,[{key:"addFollowing",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ie()("string"===typeof t,"FollowManager.addFollowing invalid userCid '".concat(t,"'")),e.next=3,this.deleteBlocked(t);case 3:return e.next=5,this.followingCache.setItem(t,!0);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"isFollowing",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){var n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ie()("string"===typeof t,"FollowManager.isFollowing invalid userCid '".concat(t,"'")),e.next=3,this.followingCache.getItem(t);case 3:return n=e.sent,e.abrupt("return",!!n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteFollowing",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ie()("string"===typeof t,"FollowManager.deleteFollowing invalid userCid '".concat(t,"'")),e.next=3,this.followingCache.removeItem(t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllFollowing",value:function(){return this.followingCache.keys()}},{key:"setAllFollowing",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){var n,r,a;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ie()(Array.isArray(t),"FollowManager.setAllFollowing invalid userCids '".concat(t,"'")),e.next=3,this.followingCache.clear();case 3:n=Object($.a)(t),e.prev=4,n.s();case 6:if((r=n.n()).done){e.next=12;break}return a=r.value,e.next=10,this.addFollowing(a);case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),n.e(e.t0);case 17:return e.prev=17,n.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[4,14,17,20]])})));return function(t){return e.apply(this,arguments)}}()},{key:"addBlocked",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ie()("string"===typeof t,"FollowManager.addBlocked invalid userCid '".concat(t,"'")),e.next=3,this.deleteFollowing(t);case 3:return e.next=5,this.blockedCache.setItem(t,!0);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"isBlocked",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){var n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ie()("string"===typeof t,"FollowManager.isBlocked invalid userCid '".concat(t,"'")),e.next=3,this.blockedCache.getItem(t);case 3:return n=e.sent,e.abrupt("return",!!n);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deleteBlocked",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ie()("string"===typeof t,"FollowManager.deleteBlocked invalid userCid '".concat(t,"'")),e.next=3,this.blockedCache.removeItem(t);case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getAllBlocked",value:function(){return this.blockedCache.keys()}},{key:"setAllBlocked",value:function(){var e=Object(Z.a)(G.a.mark((function e(t){var n,r,a;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ie()(Array.isArray(t),"FollowManager.setAllBlocked invalid userCids '".concat(t,"'")),e.next=3,this.blockedCache.clear();case 3:n=Object($.a)(t),e.prev=4,n.s();case 6:if((r=n.n()).done){e.next=12;break}return a=r.value,e.next=10,this.addBlocked(a);case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),n.e(e.t0);case 17:return e.prev=17,n.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[4,14,17,20]])})));return function(t){return e.apply(this,arguments)}}()}]),e}()),jn=hn;window.followManager=hn;var vn=Object(a.createContext)(),xn=function(e){var t=Object(a.useState)({}),n=Object(d.a)(t,2),s=n[0],c=n[1],o=Object(a.useState)({}),u=Object(d.a)(o,2),l=u[0],p=u[1];Object(a.useEffect)((function(){Object(Z.a)(G.a.mark((function e(){var t,n,r,a,s,i,o,u,l,d;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,jn.getAllFollowing();case 2:return t=e.sent,e.next=5,jn.getAllBlocked();case 5:n=e.sent,r={},a=Object($.a)(t);try{for(a.s();!(s=a.n()).done;)i=s.value,r[i]=!0}catch(f){a.e(f)}finally{a.f()}c(r),o={},u=Object($.a)(n);try{for(u.s();!(l=u.n()).done;)d=l.value,o[d]=!0}catch(f){u.e(f)}finally{u.f()}p(o);case 14:case"end":return e.stop()}}),e)})))()}),[]);var f={following:s,addFollowing:function(e){ie()("string"===typeof e,"FollowingProvider.addFollowing invalid userCid '".concat(e,"'")),jn.addFollowing(e),c((function(t){return Object(X.a)(Object(X.a)({},t),{},Object(i.a)({},e,!0))}))},deleteFollowing:function(e){ie()("string"===typeof e,"FollowingProvider.deleteFollowing invalid userCid '".concat(e,"'")),jn.deleteFollowing(e),c((function(t){return Object(X.a)(Object(X.a)({},t),{},Object(i.a)({},e,!1))}))},setAllFollowing:function(e){ie()(Array.isArray(e),"FollowingProvider.setAllFollowing invalid userCids '".concat(e,"'")),jn.setAllFollowing(e);var t,n={},r=Object($.a)(e);try{for(r.s();!(t=r.n()).done;){n[t.value]=!0}}catch(a){r.e(a)}finally{r.f()}c(n)},blocked:l,addBlocked:function(e){ie()("string"===typeof e,"FollowingProvider.addBlocked invalid userCid '".concat(e,"'")),jn.addBlocked(e),p((function(t){return Object(X.a)(Object(X.a)({},t),{},Object(i.a)({},e,!0))}))},deleteBlocked:function(e){ie()("string"===typeof e,"FollowingProvider.deleteBlocked invalid userCid '".concat(e,"'")),jn.deleteBlocked(e),p((function(t){return Object(X.a)(Object(X.a)({},t),{},Object(i.a)({},e,!1))}))},setAllBlocked:function(e){ie()(Array.isArray(e),"FollowingProvider.setAllBlocked invalid userCids '".concat(e,"'")),jn.setAllBlocked(e);var t,n={},r=Object($.a)(e);try{for(r.s();!(t=r.n()).done;){n[t.value]=!0}}catch(a){r.e(a)}finally{r.f()}p(n)}},b=e.children;return Object(r.jsx)(vn.Provider,{value:f,children:b})},gn=function(e){ie()(!e||"string"===typeof e,"useIsFollowing invalid userCid '".concat(e,"'"));var t=Object(a.useContext)(vn),n=t.following,r=t.addFollowing,s=t.deleteFollowing,c=!!n[e],i=Object(a.useCallback)((function(t){e&&(ie()("boolean"===typeof t,"setIsFollowing invalid value '".concat(t,"' not a boolean")),!0===t&&r(e),!1===t&&s(e))}),[e]);return e?[c,i]:[void 0,i]},On=Object(l.a)((function(e){return{menu:{"& .MuiPaper-rounded":{borderRadius:e.sav3.popoverMenu.borderRadius}},menuItemIcon:{minWidth:28},moreIconButton:{padding:e.spacing(.5),"& .MuiSvgIcon-root":{fontSize:"1.2rem"}}}}));function mn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userCid,n=On(),a=q(),s=gn(t),c=Object(d.a)(s,2),i=c[0],o=c[1],u=Object(r.jsxs)(Dt.a,{onClick:function(){return o(!0)},children:[Object(r.jsx)(h.a,{className:n.menuItemIcon,children:Object(r.jsx)(ln.a,{fontSize:"small"})}),Object(r.jsx)(pt.a,{children:a.Follow()})]});return i&&(u=Object(r.jsxs)(Dt.a,{onClick:function(){return o(!1)},children:[Object(r.jsx)(h.a,{className:n.menuItemIcon,children:Object(r.jsx)(dn.a,{fontSize:"small"})}),Object(r.jsx)(pt.a,{children:a.Unfollow()})]})),u}mn.propTypes={userCid:bn.a.string.isRequired};var yn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.post,n=On(),s=Object(a.useState)(null),c=Object(d.a)(s,2),i=c[0],o=c[1],u=ut();if(t.userCid===u)return Object(r.jsx)(R.a,{height:48,width:48});var l=function(e){o(e.currentTarget)},p=function(){o(null)};return Object(r.jsxs)("div",{onClick:function(e){return e.stopPropagation()},children:[Object(r.jsx)(nt.a,{className:n.moreIconButton,onClick:l,children:Object(r.jsx)(on.a,{})}),Object(r.jsx)(sn.a,{className:n.menu,elevation:4,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},anchorEl:i,keepMounted:!0,open:Boolean(i),onClose:p,children:Object(r.jsx)(mn,{userCid:t.userCid})})]})},wn=_e.a.urlTimeToLive;ie()("number"===typeof wn,"invalid permalink time to live '".concat(wn,"'"));var Cn=function(e){var t,n;ie()(e&&"string"===typeof e,"utils.url.decodeCid encodedCid '".concat(e,"' not a string"));try{var r=JSON.parse(window.atob(e));t=r.c,n=r.e}catch(a){throw Error("failed decoding cid: ".concat(a.message))}if(1e3*n<Date.now())throw Error("encoded cid '".concat(t,"' expired ").concat(new Date(1e3*n)));if(1e3*n-wn>Date.now())throw Error("encoded cid '".concat(t,"' too early ").concat(new Date(1e3*n)));return t},kn=Cn,Sn=function(e){ie()(e&&"string"===typeof e,"utils.url.encodeCid cid '".concat(e,"' not a string"));var t=Math.round((Date.now()+wn)/1e3);return window.btoa(JSON.stringify({c:e,e:t})).replace(/=/g,"")},In=function(e){try{return Cn(e),!1}catch(t){return console.log(t),!0}},Pn=function(){};var Fn=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=Object(a.useRef)(Pn);Object(a.useEffect)((function(){r.current=e})),Object(a.useEffect)((function(){n&&null!==t&&!1!==t&&r.current()}),[n]),Object(a.useEffect)((function(){if(null!==t&&!1!==t){var e=setInterval((function(){return r.current()}),t);return function(){return clearInterval(e)}}}),[t])},Rn=function(e){ie()(!e||"string"===typeof e,"invalid postCid '".concat(JSON.stringify(e),"'"));var t=Object(a.useState)([]),n=Object(d.a)(t,2),r=n[0],s=n[1];return Fn((function(){e?Object(Z.a)(G.a.mark((function t(){var n;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Qe.getPostRepliesCids(e);case 2:n=t.sent,s(n);case 4:case"end":return t.stop()}}),t)})))():s([])}),1e3),r},Nn=n(547),Bn=n.n(Nn);function Un(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:500,t=Object(a.useState)(!1),n=Object(d.a)(t,2),r=n[0],s=n[1],c=Object(a.useCallback)((function(e){var t=Bn()(e);s(t)}),[]);return Object(a.useEffect)((function(){if(r){var t=setTimeout((function(){s(!1)}),e);return function(){clearTimeout(t)}}}),[r,s,e]),[r,c]}var Dn=Object(l.a)((function(e){return{imgMedia:{height:0,paddingTop:"56.25%"},avatar:{marginTop:e.spacing(-.25),width:e.spacing(6),height:e.spacing(6),borderWidth:e.sav3.borderWidth,borderStyle:"solid",borderColor:e.sav3.borderColor},userCid:{wordBreak:"break-all",textDecoration:"inherit"},displayName:{color:"inherit",textDecoration:"inherit"},contentLink:{wordBreak:"break-all"},actions:{paddingTop:e.spacing(.5),maxWidth:.75*e.sav3.layout.columns.middle.width.md,marginLeft:e.spacing(-1)},actionIconButton:{padding:e.spacing(1),"& .MuiSvgIcon-root":{fontSize:"1rem",color:e.palette.text.secondary}},post:{cursor:"pointer","&:hover":{backgroundColor:Tn(e.palette.action.hover,.4)},tapHighlightColor:"rgba(0, 0, 0, 0)",userSelect:"none"}}})),Tn=function(e,t){var n=e.match(/[\d.]+/g),r=Object(d.a)(n,4),a=r[0],s=r[1],c=r[2],i=r[3];return"rgba(".concat(a,", ").concat(s,", ").concat(c,", ").concat((i*t).toFixed(3),")")};function Wn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.parentPost,n=Dn(),s=Rn(t.cid),c=Object(a.useState)(!1),i=Object(d.a)(c,2),o=i[0],u=i[1];return Object(r.jsxs)(R.a,{display:"flex",alignItems:"center",onClick:function(e){return e.stopPropagation()},children:[Object(r.jsx)(nt.a,{className:n.actionIconButton,onClick:function(){return u(!0)},children:Object(r.jsx)(Yt.a,{})}),0!==s.length&&Object(r.jsx)(pt.a,{variant:"caption",children:s.length}),Object(r.jsx)(bt,{parentPost:t,open:o,onClose:function(){return u(!1)}})]})}function An(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.postCid,n=Dn(),a=q(),s=Un(1100),c=Object(d.a)(s,2),i=c[0],o=c[1],u=function(){var e=Sn(t);return"".concat(window.location.origin,"/#/post/").concat(e)};return Object(r.jsx)(tn.a,{title:a["Copied to clipboard"](),open:i,enterDelay:500,leaveDelay:200,children:Object(r.jsx)(nt.a,{onClick:function(){return o(u())},className:n.actionIconButton,children:Object(r.jsx)(Zt.a,{})})})}function En(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.content,n=Dn(),a=[t],s=Ln(t);if(s){var c=t.split(s),i=Object(d.a)(c,2),o=i[0],u=i[1],l=s;s.match(/^https?:\/\//)||(l="https://".concat(s)),a=[],o&&a.push(o),a.push(Object(r.jsx)(en.a,{className:n.contentLink,variant:"body2",href:l,target:"_blank",rel:"noopener",children:s},"content link")),u&&a.push(u)}var p,f=Mn(t);f&&(p=Object(r.jsx)(_t.a,{className:n.imgMedia,image:f}),Kn(f)&&(p=Object(r.jsx)(_t.a,{controls:!0,autoPlay:!0,muted:!0,component:"video",image:f})));var b=f&&Object(r.jsx)(R.a,{pt:1,children:Object(r.jsx)(Ht.a,{variant:"outlined",children:p})});return Object(r.jsxs)(R.a,{children:[Object(r.jsx)(pt.a,{variant:"body2",children:a}),b]})}var Ln=function(e){if(e){ie()("string"===typeof e,"post content '".concat(e,"' is not a string"));var t=e.match(an()({strict:!1}));return t&&t[0]}},Mn=function(e){if(e){ie()("string"===typeof e,"post content '".concat(e,"' is not a string"));var t=e.match(an()({strict:!1})),n=t&&t[0];if(n)return n=zn(n),Jn(n)?(n.match(/^https?:\/\//)||(n="https://".concat(n)),n):void 0}},zn=function(e){return ie()("string"===typeof e,"forceHttps link '".concat(e,"' not a string")),e=(e=e.trim()).replace(/^http:\/\//,"https://")},Kn=function(e){return e.replace(/[#?].*/).match(/\.(mp4|webm)$/)},Jn=function(e){return e.replace(/[#?].*/).match(/\.(jpeg|jpg|png|gif|mp4|webm)$/)},_n=function(e,t){var n=Object(a.useState)(),r=Object(d.a)(n,2),s=r[0],c=r[1];return Object(a.useEffect)((function(){var n=Hn(e,t);c(n)}),[e,t]),s},Hn=function(e,t){var n=864e5,r=1e3*e,a=new Date(r).toLocaleString(t,{month:"short",day:"numeric"});return Date.now()>r+31536e6&&(a=new Date(r).toLocaleString(t,{year:"numeric",month:"short",day:"numeric"})),Date.now()<r+n&&(a=Object(L.a)(r,t)),a},qn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.post,n=Object(o.g)(),s=Object(o.f)(),c=nn(),i=Dn(),u=_n(t.timestamp,c),l=Sn(t.userCid),p="/profile/".concat(l),f=Sn(t.cid),b="/post/".concat(f),h=function(e){if(e.target.tagName.match(/DIV|P/)){var r=n.pathname.split("/"),a=Object(d.a)(r,3),c=a[1],i=a[2];if("post"===c)try{if(kn(i)===t.cid)return}catch(o){}s.push(b)}};return Object(r.jsxs)(R.a,{px:2,pt:1.5,pb:.5,display:"flex",className:i.post,onClick:h,children:[Object(r.jsx)(R.a,{pr:1.5,children:Object(r.jsx)(lt.a,{component:D.b,to:p,src:t.profile.thumbnailUrl&&zn(t.profile.thumbnailUrl),className:i.avatar})}),Object(r.jsxs)(R.a,{width:"100%",children:[Object(r.jsxs)(R.a,{display:"flex",children:[Object(r.jsxs)(R.a,{flexGrow:1,children:[Object(r.jsxs)(R.a,{display:"flex",children:[t.profile.displayName&&Object(r.jsxs)(a.Fragment,{children:[Object(r.jsx)(pt.a,{className:i.displayName,component:D.b,to:p,variant:"subtitle2",children:t.profile.displayName}),"\xa0",Object(r.jsx)(pt.a,{variant:"subtitle2",children:"\xb7"}),"\xa0"]}),Object(r.jsx)(pt.a,{variant:"subtitle2",children:u})]}),Object(r.jsx)(R.a,{children:Object(r.jsx)(pt.a,{component:D.b,to:p,variant:"caption",color:"textSecondary",className:i.userCid,children:t.userCid})})]}),Object(r.jsx)(R.a,{children:Object(r.jsx)(yn,{post:t})})]}),Object(r.jsx)(En,{content:t.content}),Object(r.jsxs)(R.a,{display:"flex",justifyContent:"space-between",className:i.actions,children:[Object(r.jsx)(Wn,{parentPost:t}),Object(r.jsx)(nt.a,{className:i.actionIconButton,children:Object(r.jsx)(Xt.a,{style:{transform:"rotate(90deg)"}})}),Object(r.jsx)(nt.a,{className:i.actionIconButton,children:Object(r.jsx)(Vt.a,{})}),Object(r.jsx)(An,{postCid:t.cid})]})]})]})};var Vn=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.posts,a=[],s=Object($.a)(n);try{for(s.s();!(e=s.n()).done;){var c=e.value;a.push(Object(r.jsx)(qn,{post:c},c.contentCid+c.timestamp)),a.push(Object(r.jsx)(rt.a,{},c.contentCid+c.timestamp+"feed divider"))}}catch(i){s.e(i)}finally{s.f()}return Object(r.jsx)("div",{children:a})},Gn=function(e){ie()(!e||"string"===typeof e,"invalid userCid '".concat(JSON.stringify(e),"'"));var t=[],n=Object(a.useState)(t),r=Object(d.a)(n,2),s=r[0],c=r[1],i=it(e),o=ot(e),u=i&&i.lastPostCid;return console.log("useUserPosts",{userIpnsData:i,userCid:e,userPosts:s}),Object(a.useEffect)((function(){u&&"string"===typeof u?Object(Z.a)(G.a.mark((function e(){var t,n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe.getUserPostsFromLastPostCid(u);case 2:for(n in t=e.sent)t[n].profile=o||{};c(t);case 5:case"end":return e.stop()}}),e)})))():c(t)}),[u,JSON.stringify(o)]),s};var Zn=function(e){if(e){ie()("string"===typeof e,"user description '".concat(e,"' is not a string"));var t=e.match(an()({strict:!1}));return t&&t[0]}},Qn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.description,n=[t],a=Zn(t);if(a){var s=t.split(a),c=Object(d.a)(s,2),i=c[0],o=c[1],u=a;a.match(/$https?:\/\//)||(u="https://".concat(a)),n=[],i&&n.push(i),n.push(Object(r.jsx)(en.a,{variant:"body2",href:u,target:"_blank",rel:"noopener",children:a})),o&&n.push(o)}return Object(r.jsx)(pt.a,{variant:"body2",children:n})},Xn=Object(l.a)((function(e){return{errorMessage:{overflow:"hidden"},description:{"& textarea":{overflow:"hidden"}},content:{"& input":{padding:e.spacing(2),paddingLeft:e.spacing(2.5),paddingRight:e.spacing(2.5)},'& label[data-shrink="false"]':{transform:"translate(20px, 18px) scale(1)"},"& textarea":{paddingTop:e.spacing(1),paddingBottom:e.spacing(1),paddingLeft:e.spacing(.5),paddingRight:e.spacing(.5)},"& fieldset":{opacity:.25},"& .Mui-focused fieldset":{opacity:1}}}}));var $n=function(e){var t=e.open,n=e.onClose,s=e.previousProfile,c=q(),o=Xn(),u=Object(a.useState)(s),l=Object(d.a)(u,2),p=l[0],f=l[1],b=Object(a.useState)(),h=Object(d.a)(b,2),j=h[0],v=h[1];Object(a.useEffect)((function(){f(s)}),[JSON.stringify(s)]);var x=function(e){var t=e.target,n=t.id,r=t.value,a=Object(X.a)(Object(X.a)({},p),{},Object(i.a)({},n,r));f(a)},g=function(){var e=Object(Z.a)(G.a.mark((function e(){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Qe.editUserProfile(p);case 3:v(null),n(),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),v(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),O=Object(r.jsxs)(R.a,{pt:1,pb:1.5,className:o.content,children:[Object(r.jsx)(Q.a,{onChange:x,autoFocus:!0,margin:"dense",id:"displayName",label:c["Display name"](),fullWidth:!0,variant:"outlined",value:p.displayName||""}),Object(r.jsx)(Q.a,{onChange:x,margin:"dense",id:"thumbnailUrl",label:c["Thumbnail URL"](),fullWidth:!0,variant:"outlined",value:p.thumbnailUrl||""}),Object(r.jsx)(Q.a,{onChange:x,margin:"dense",id:"bannerUrl",label:c["Banner URL"](),fullWidth:!0,variant:"outlined",value:p.bannerUrl||""}),Object(r.jsx)(Q.a,{className:o.description,onChange:x,margin:"dense",id:"description",label:c.Description(),fullWidth:!0,multiline:!0,rows:4,variant:"outlined",value:p.description||""}),j&&Object(r.jsx)(Xe.a,{classes:{message:o.errorMessage},severity:"error",children:j})]}),m=Object(r.jsx)("div",{children:Object(r.jsx)(F.a,{disableElevation:!0,variant:"contained",onClick:g,color:"primary",children:"SAV3"})});return Object(r.jsx)(ct,{open:t,onClose:n,content:O,actions:m})},Yn=Object(l.a)((function(e){return{menu:{"& .MuiPaper-rounded":{borderRadius:e.sav3.popoverMenu.borderRadius}},menuItemIcon:{minWidth:28},moreIconButton:{padding:e.spacing(1.25)}}}));function er(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userCid,n=Yn(),a=q(),s=Un(1100),c=Object(d.a)(s,2),i=c[0],o=c[1],u=function(){var e=Sn(t);return"".concat(window.location.origin,"/#/profile/").concat(e)};return Object(r.jsx)(tn.a,{title:a["Copied to clipboard"](),open:i,enterDelay:500,leaveDelay:200,children:Object(r.jsxs)(Dt.a,{onClick:function(){return o(u())},children:[Object(r.jsx)(h.a,{className:n.menuItemIcon,children:Object(r.jsx)(Zt.a,{fontSize:"small"})}),Object(r.jsx)(pt.a,{children:a.Share()})]})})}var tr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userCid,n=Yn(),s=Object(a.useState)(null),c=Object(d.a)(s,2),i=c[0],o=c[1],u=function(e){o(e.currentTarget)},l=function(){o(null)};return Object(r.jsxs)("div",{children:[Object(r.jsx)(nt.a,{className:n.moreIconButton,onClick:u,children:Object(r.jsx)(on.a,{})}),Object(r.jsx)(sn.a,{className:n.menu,elevation:4,anchorOrigin:{vertical:"top",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},anchorEl:i,keepMounted:!0,open:Boolean(i),onClose:l,children:Object(r.jsx)(er,{userCid:t})})]})},nr="data:image/png;base64,",rr=Object(l.a)((function(e){return{banner:{paddingTop:"33.25%"},avatar:Object(i.a)({position:"absolute",width:e.sav3.layout.columns.middle.width.md/4,height:e.sav3.layout.columns.middle.width.md/4,marginTop:e.sav3.layout.columns.middle.width.md/-8,marginLeft:e.spacing(2),borderWidth:e.spacing(.5),borderStyle:"solid",borderColor:e.palette.background.default},e.breakpoints.down(e.sav3.layout.columns.middle.width.md),{width:"25vw",height:"25vw",marginTop:"-12.5vw",borderWidth:e.spacing(.25)}),displayName:{wordBreak:"break-all"}}}));function ar(e){var t=e.profile,n=q(),s=Object(a.useState)(!1),c=Object(d.a)(s,2),i=c[0],o=c[1];return Object(r.jsxs)("div",{children:[Object(r.jsx)(F.a,{variant:"outlined",size:"large",color:"primary",onClick:function(){return o(!0)},children:n["Edit profile"]()}),Object(r.jsx)($n,{previousProfile:t,open:i,onClose:function(){return o(!1)}})]})}function sr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userCid,n=q(),a=gn(t),s=Object(d.a)(a,2),c=s[0],i=s[1],o=Object(r.jsx)(F.a,{variant:"outlined",size:"large",color:"primary",onClick:function(){return i(!0)},children:n.Follow()});return c&&(o=Object(r.jsx)(F.a,{variant:"outlined",size:"large",color:"primary",onClick:function(){return i(!1)},children:n.Unfollow()})),o}sr.propTypes={userCid:bn.a.string.isRequired};var cr=function(e){return ie()("string"===typeof e,"forceHttps link '".concat(e,"' not a string")),e=(e=e.trim()).replace(/^http:\/\//,"https://")},ir=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.userCid,a=ut(),s=rr(),c=Gn(n),i=ot(n);console.log("Profile",{ownCid:a,userCid:n,posts:c,profile:i}),n===a?e=Object(r.jsx)(ar,{profile:i}):a&&(e=Object(r.jsx)(sr,{userCid:n}));var o=i.description||"";return o&&o.length>140&&(o=o.substring(0,140)),Object(r.jsxs)("div",{className:s.root,children:[Object(r.jsx)(_t.a,{className:s.banner,image:i.bannerUrl&&cr(i.bannerUrl)||nr}),Object(r.jsx)(lt.a,{src:i.thumbnailUrl&&cr(i.thumbnailUrl),className:s.avatar}),Object(r.jsxs)(R.a,{p:2,pb:0,display:"flex",flexDirection:"row-reverse",children:[e,Object(r.jsx)(tr,{userCid:n})]}),Object(r.jsx)(Jt.a,{className:s.displayName,pb:0,title:i.displayName,subheader:n}),Object(r.jsx)(R.a,{p:2,pt:0,children:Object(r.jsx)(Qn,{description:o})}),Object(r.jsx)(rt.a,{}),Object(r.jsx)(Vn,{posts:c})]})};var or=function(){var e,t=Object(o.h)().encodedCid,n=t&&In(t);!n&&t&&(e=kn(t));var a,s=!t,c=ut(),i=ot(a=s?c:e),u=Object(o.f)(),l=q();return console.log("Profile",{userCid:a,urlUserCid:e,urlIsExpired:n,isOwnProfile:s}),Object(r.jsxs)("div",{children:[Object(r.jsxs)(Mt,{children:[Object(r.jsx)(R.a,{pr:1,children:Object(r.jsx)(nt.a,{onClick:function(){return u.goBack()},children:Object(r.jsx)(Kt.a,{})})}),Object(r.jsx)(pt.a,{noWrap:!0,variant:"h6",children:i.displayName||s&&l["Edit profile"]()})]}),n&&Object(r.jsx)(R.a,{width:"100%",py:4,display:"flex",justifyContent:"center",alignItems:"center",children:Object(r.jsx)(pt.a,{variant:"body1",children:l["URL expired"]()+"."})}),!n&&Object(r.jsx)(ir,{userCid:a})]})},ur=n(64),lr=function(){var e=Object(a.useState)(),t=Object(d.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){Object(Z.a)(G.a.mark((function e(){var t;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe.getOwnPeerCid();case 2:t=e.sent,r(t);case 4:case"end":return e.stop()}}),e)})))()}),[]),n},pr=n(1365),dr=Object(l.a)((function(e){return{text:{},root:{width:e.sav3.drawerMenu.width}}}));var fr=function(){var e=dr(),t=q();return Object(r.jsx)("div",{className:e.root,children:Object(r.jsxs)(f.a,{children:[Object(r.jsxs)(b.a,{button:!0,component:D.b,to:"/following",children:[Object(r.jsx)(h.a,{children:Object(r.jsx)(C.a,{fontSize:"large"})}),Object(r.jsx)(j.a,{primary:t.Following(),className:e.text})]}),Object(r.jsxs)(b.a,{button:!0,component:D.b,to:"/profile",children:[Object(r.jsx)(h.a,{children:Object(r.jsx)(O.a,{fontSize:"large"})}),Object(r.jsx)(j.a,{primary:t.Profile(),className:e.text})]}),Object(r.jsxs)(b.a,{children:[Object(r.jsx)(Tt,{}),Object(r.jsx)(Wt,{})]})]})})},br=Object(l.a)((function(e){return{avatar:{width:e.sav3.topBar.height/1.75,height:e.sav3.topBar.height/1.75}}}));var hr=function(){var e=lr(),t=br(),n=ot(e),s=Object(a.useState)(!1),c=Object(d.a)(s,2),i=c[0],o=c[1];return Object(r.jsxs)("div",{children:[Object(r.jsx)(nt.a,{style:{backgroundColor:"transparent"},disableRipple:!0,disableFocusRipple:!0,onClick:function(){return o(!0)},children:Object(r.jsx)(lt.a,{src:n.thumbnailUrl,className:t.avatar})}),Object(r.jsx)(pr.a,{achor:"left",elevation:2,open:i,onClose:function(){return o(!1)},children:Object(r.jsx)(fr,{})})]})},jr=function(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),n=t[0],r=t[1];return Object(a.useEffect)((function(){Object(Z.a)(G.a.mark((function e(){var t;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,jn.getAllFollowing();case 2:t=e.sent,r(t);case 4:case"end":return e.stop()}}),e)})))()}),[]),n},vr=function(e){ie()(Array.isArray(e),"invalid ipnsPaths '".concat(JSON.stringify(e),"'"));var t=Object(a.useState)({}),n=Object(d.a)(t,2),r=n[0],s=n[1];return console.log("useUsersIpnsData",{ipnsPaths:e,usersIpnsData:r}),Object(a.useEffect)((function(){if(e.length){var t=new Set(e),n=function(){var e=Object(Z.a)(G.a.mark((function e(n,r){var a;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.has(n)){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,Qe.getIpfsFile(r);case 4:a=e.sent,s((function(e){return Object(X.a)(Object(X.a)({},e),{},Object(i.a)({},n,JSON.parse(a)))}));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Qe.on("publish",n),Object(Z.a)(G.a.mark((function t(){var n,r,a,c;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Qe.subscribeToIpnsPaths(e);case 2:n=t.sent,r=Object($.a)(n.entries()),t.prev=4,c=function(){var t=Object(d.a)(a.value,2),n=t[0],r=t[1];if(!r)return"continue";var c=e[n];Qe.getIpfsFile(r).then((function(e){s((function(t){return Object(X.a)(Object(X.a)({},t),{},Object(i.a)({},c,JSON.parse(e)))}))}))},r.s();case 7:if((a=r.n()).done){t.next=13;break}if("continue"!==c()){t.next=11;break}return t.abrupt("continue",11);case 11:t.next=7;break;case 13:t.next=18;break;case 15:t.prev=15,t.t0=t.catch(4),r.e(t.t0);case 18:return t.prev=18,r.f(),t.finish(18);case 21:case"end":return t.stop()}}),t,null,[[4,15,18,21]])})))(),function(){Qe.off("publish",n)}}}),[JSON.stringify(e)]),r},xr=function(e){ie()(Array.isArray(e),"invalid userCids '".concat(JSON.stringify(e),"'"));var t=Object(a.useState)({}),n=Object(d.a)(t,2),r=n[0],s=n[1],c=vr(e),o={};for(var u in c)o[u]=c[u].profileCid;return console.log("useUsersProfiles",{usersIpnsData:c,userCids:e,profileCids:o,usersProfiles:r}),Object(a.useEffect)((function(){var e=function(e){var t=o[e];if(!t||"string"!==typeof t)return"continue";Qe.getUserProfile(t).then((function(t){s((function(n){return Object(X.a)(Object(X.a)({},n),{},Object(i.a)({},e,t))}))}))};for(var t in o)e(t)}),[JSON.stringify(o)]),r},gr=function(e){ie()(Array.isArray(e),"invalid userCids '".concat(JSON.stringify(e),"'"));var t=Object(a.useState)([]),n=Object(d.a)(t,2),r=n[0],s=n[1],c=vr(e),i=xr(e),o=[];for(var u in c)o.push(c[u].lastPostCid);return console.log("useUsersPosts",{usersIpnsData:c,userCids:e,lastPostCids:o,usersPosts:r,profiles:i}),Object(a.useEffect)((function(){if(o.length){var e,t=Object($.a)(o);try{for(t.s();!(e=t.n()).done;){var n=e.value;n&&"string"===typeof n&&Qe.getUserPostsFromLastPostCid(n).then((function(e){var t,n={},r=Object($.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;a.profile=i[a.userCid]||{},n[a.cid]=a}}catch(c){r.e(c)}finally{r.f()}s((function(e){return Object(X.a)(Object(X.a)({},e),n)}))}))}}catch(r){t.e(r)}finally{t.f()}}}),[JSON.stringify(o),JSON.stringify(i)]),r},Or=Object(l.a)((function(e){return{errorMessage:{overflow:"hidden"},content:{"& textarea":{overflow:"hidden"},"& fieldset":{border:"none"},"& .MuiInputBase-root":{paddingLeft:0,paddingRight:0},marginBottom:e.spacing(1)},contentInput:{paddingTop:0,paddingBottom:0},avatar:{marginTop:e.spacing(-.25),width:e.spacing(6),height:e.spacing(6),borderWidth:e.sav3.borderWidth,borderStyle:"solid",borderColor:e.sav3.borderColor}}}));var mr=function(){var e=q(),t=Or(),n=Object(p.a)(),s=ut(),c=ot(s),i=Object(a.useState)(""),o=Object(d.a)(i,2),u=o[0],l=o[1],f=Object(a.useState)(),b=Object(d.a)(f,2),h=b[0],j=b[1],v=function(){var e=Object(Z.a)(G.a.mark((function e(){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Qe.publishPost({content:u});case 3:j(null),l(""),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),j(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),x=Object(r.jsxs)("div",{children:[Object(r.jsx)(R.a,{children:Object(r.jsx)(rt.a,{})}),Object(r.jsxs)(R.a,{alignItems:"center",display:"flex",height:n.sav3.topBar.height,children:[Object(r.jsx)(R.a,{flexGrow:1}),Object(r.jsx)(F.a,{disableElevation:!0,variant:"contained",onClick:v,color:"primary",children:"SAV3"})]})]});return Object(r.jsxs)(R.a,{px:2,display:"flex",children:[Object(r.jsx)(R.a,{pr:1.5,py:1.5,children:Object(r.jsx)(lt.a,{src:c.thumbnailUrl,className:t.avatar})}),Object(r.jsxs)(R.a,{pt:1,width:"100%",children:[Object(r.jsx)(Q.a,{className:t.content,onChange:function(e){var t=e.target.value;try{t.length>140&&(t=t.subtring(0,140)),l(t)}catch(n){}},margin:"dense",id:"content",placeholder:e["Uncensorable content"](),fullWidth:!0,multiline:!0,variant:"outlined",value:u}),h&&Object(r.jsx)(R.a,{py:1,children:Object(r.jsx)(Xe.a,{classes:{message:t.errorMessage},severity:"error",children:h})}),x]})]})},yr=n(1355);var wr=function(){var e=Object(p.a)(),t=Object(at.a)(e.breakpoints.down("xs")),n=q(),a=jr(),s=ut();s&&(a=[s].concat(Object(ur.a)(a)));var c=gr(a),i=[];for(var o in c)i.push(c[o]);console.log("Home",{followingCids:a,posts:i,postsObject:c});var u=Object(r.jsx)(Vn,{posts:i});return i.length||(u=Object(r.jsxs)(R.a,{width:"100%",py:4,display:"flex",justifyContent:"center",alignItems:"center",children:[Object(r.jsx)(yr.a,{size:24}),Object(r.jsx)(R.a,{p:.5}),Object(r.jsx)(pt.a,{variant:"body1",children:n["Connecting to peers"]()+"..."})]})),i.length||a.length||(u=Object(r.jsx)(R.a,{width:"100%",py:4,display:"flex",justifyContent:"center",alignItems:"center",children:Object(r.jsx)(pt.a,{variant:"body1",children:n["Not following anyone"]()+"..."})})),Object(r.jsxs)("div",{children:[Object(r.jsxs)(Mt,{children:[t&&Object(r.jsx)(R.a,{pl:2,pr:1,children:Object(r.jsx)(hr,{})}),Object(r.jsx)(R.a,{pl:2,children:Object(r.jsx)(pt.a,{noWrap:!0,variant:"h6",children:n.Home()})})]}),!t&&Object(r.jsxs)("div",{children:[Object(r.jsxs)(R.a,{pb:1,children:[Object(r.jsx)(mr,{}),Object(r.jsx)(rt.a,{})]}),Object(r.jsx)(rt.a,{})]}),u]})},Cr=n(1356),kr=n(91),Sr=n.n(kr),Ir=Object(l.a)((function(e){return{search:{height:e.sav3.topBar.height/1.5,"& fieldset":{border:"none",backgroundColor:e.palette.divider}}}}));var Pr=function(){var e=Ir(),t=Object(p.a)(),n=Object(at.a)(t.breakpoints.down("xs")),s=Object(a.useState)(""),c=Object(d.a)(s,2),i=c[0],o=c[1],u=q();return Object(r.jsxs)("div",{children:[Object(r.jsxs)(Mt,{children:[Object(r.jsx)(R.a,{pl:n?2:4,children:n&&Object(r.jsx)(R.a,{pr:.5,children:Object(r.jsx)(hr,{})})}),Object(r.jsx)(R.a,{width:"100%",pl:0,pr:4,children:Object(r.jsx)(Q.a,{onChange:function(e){var t=e.target.value;try{t=t.trim(),o(t)}catch(n){}},InputProps:{spellCheck:!1,classes:{root:e.search},startAdornment:Object(r.jsx)(R.a,{pr:1,children:Object(r.jsx)(Cr.a,{position:"start",children:Object(r.jsx)(y.a,{})})})},variant:"outlined",fullWidth:!0,placeholder:u["Search user ID"](),value:i})})]}),Sr.a.cid(i)&&Object(r.jsx)(ir,{userCid:i})]})},Fr=function(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(0),c=Object(d.a)(s,2),i=c[0],o=c[1];return Object(a.useEffect)((function(){setInterval((function(){o(i+1)}),2e3)}),[]),Object(a.useEffect)((function(){Object(Z.a)(G.a.mark((function e(){var t;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe.getPeersCids();case 2:t=e.sent,r(t);case 4:case"end":return e.stop()}}),e)})))()}),[i]),n};var Rr=function(){var e=Object(p.a)(),t=Object(at.a)(e.breakpoints.down("xs")),n=q(),a=Object(o.f)(),s=Fr(),c=ut();c&&(s=[c].concat(Object(ur.a)(s)));var i=gr(s),u=[];for(var l in i)u.push(i[l]);console.log("Peers",{peersCids:s,posts:u,postsObject:i});var d=Object(r.jsx)(Vn,{posts:u});return u.length||(d=Object(r.jsxs)(R.a,{width:"100%",py:4,display:"flex",justifyContent:"center",alignItems:"center",children:[Object(r.jsx)(yr.a,{size:24}),Object(r.jsx)(R.a,{p:.5}),Object(r.jsx)(pt.a,{variant:"body1",children:n["Connecting to peers"]()+"..."})]})),Object(r.jsxs)("div",{children:[Object(r.jsxs)(Mt,{children:[Object(r.jsx)(R.a,{pr:1,children:Object(r.jsx)(nt.a,{onClick:function(){return a.goBack()},children:Object(r.jsx)(Kt.a,{})})}),Object(r.jsx)(pt.a,{noWrap:!0,variant:"h6",children:n["Connected peers posts"]()})]}),!t&&Object(r.jsxs)("div",{children:[Object(r.jsxs)(R.a,{pb:1,children:[Object(r.jsx)(mr,{}),Object(r.jsx)(rt.a,{})]}),Object(r.jsx)(rt.a,{})]}),d]})},Nr=new Set,Br=de({name:"ipIsoCountryCodeCache",maxSize:2e3}),Ur=function(){var e=Object(Z.a)(G.a.mark((function e(t){var n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Br.get(t);case 2:if(!(n=e.sent)){e.next=5;break}return e.abrupt("return",n);case 5:throw Nr.has(t)||(Nr.add(t),Dr(t).then((function(e){return Br.set(t,e)})).catch((function(e){return console.log(e)}))),Error("iso country code for ip '".concat(t,"' not cached yet"));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Dr=function(){var e=Object(Z.a)(G.a.mark((function e(t){var n,r,a;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ie()("string"===typeof t,"invalid ip '".concat(t,"' not a string")),n="https://ipapi.co/".concat(t,"/country/"),e.prev=2,e.next=5,fetch(n);case 5:return a=e.sent,e.next=8,a.text();case 8:a=e.sent,r=a.trim().toUpperCase(),Tr(r),e.next=17;break;case 13:throw e.prev=13,e.t0=e.catch(2),e.t0.message="failed getting country iso code from '".concat(n,"' response '").concat(a,"': ").concat(e.t0.message),e.t0;case 17:return e.abrupt("return",r);case 18:case"end":return e.stop()}}),e,null,[[2,13]])})));return function(t){return e.apply(this,arguments)}}(),Tr=function(e){var t=typeof e;ie()(/^[a-z]{2}$/i.test(e),"isoCountryCode must be an ISO 3166-1 alpha-2 string, but got '".concat("string"===t?e:t,"' instead"))},Wr={getIsoCountryCodeFromIpCached:Ur,getIsoCountryCodeFromIp:Dr,getIsoCountryCodesFromIps:function(e){var t,n=[],r=Object($.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value;n.push(Dr(a))}}catch(s){r.e(s)}finally{r.f()}return Promise.all(n)},isoCountryCodeToCountryFlagEmoji:function(e){Tr(e);var t=Object(ur.a)(e.toUpperCase()).map((function(e){return e.charCodeAt()+127397}));return String.fromCodePoint.apply(String,Object(ur.a)(t))}},Ar=function(){var e=Object(a.useState)([]),t=Object(d.a)(e,2),n=t[0],r=t[1],s=Object(a.useState)(0),c=Object(d.a)(s,2),i=c[0],o=c[1];return Object(a.useEffect)((function(){setInterval((function(){o(i+1)}),5e3)}),[]),Object(a.useEffect)((function(){Object(Z.a)(G.a.mark((function e(){var t,n,a,s,c,i;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Qe.getPeersStats();case 2:t=e.sent,n=Object($.a)(t),e.prev=4,n.s();case 6:if((a=n.n()).done){e.next=26;break}if((s=a.value).ip){e.next=10;break}return e.abrupt("continue",24);case 10:return c=void 0,e.prev=11,e.next=14,Wr.getIsoCountryCodeFromIpCached(s.ip);case 14:c=e.sent,e.next=21;break;case 17:return e.prev=17,e.t0=e.catch(11),console.log(e.t0),e.abrupt("continue",24);case 21:i=Wr.isoCountryCodeToCountryFlagEmoji(c),s.isoCountryCode=c,s.countryFlagEmoji=i;case 24:e.next=6;break;case 26:e.next=31;break;case 28:e.prev=28,e.t1=e.catch(4),n.e(e.t1);case 31:return e.prev=31,n.f(),e.finish(31);case 34:r(t);case 35:case"end":return e.stop()}}),e,null,[[4,28,31,34],[11,17]])})))()}),[i]),n},Er=n(358),Lr=n.n(Er),Mr=Object(l.a)((function(e){return{avatar:{marginTop:e.spacing(-.25),width:e.spacing(6),height:e.spacing(6),borderWidth:e.sav3.borderWidth,borderStyle:"solid",borderColor:e.sav3.borderColor,backgroundColor:e.palette.background.default},userCid:{wordBreak:"break-all"}}}));var zr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.peer,n=Mr();return Object(r.jsx)("div",{children:Object(r.jsxs)(R.a,{px:2,py:1.5,display:"flex",children:[Object(r.jsx)(R.a,{pr:1.5,children:Object(r.jsx)(lt.a,{className:n.avatar,children:t.countryFlagEmoji})}),Object(r.jsxs)(R.a,{width:"100%",children:[Object(r.jsxs)(R.a,{display:"flex",children:[Object(r.jsxs)(R.a,{flexGrow:1,children:[Object(r.jsx)(R.a,{display:"flex",children:Object(r.jsxs)(pt.a,{variant:"subtitle2",children:[t.ip,":",t.port]})}),Object(r.jsx)(R.a,{children:Object(r.jsx)(pt.a,{variant:"caption",color:"textSecondary",className:n.userCid,children:t.peerCid})})]}),Object(r.jsx)(R.a,{height:48})]}),Object(r.jsxs)(pt.a,{variant:"body2",children:["\u2b06\ufe0f",Lr()(t.dataSent),"\xa0\xa0\u2b07\ufe0f",Lr()(t.dataReceived)]})]})]})})};function Kr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.peers,n=q();if(!t.length)return Object(r.jsxs)(R.a,{width:"100%",py:4,display:"flex",justifyContent:"center",alignItems:"center",children:[Object(r.jsx)(yr.a,{size:24}),Object(r.jsx)(R.a,{p:.5}),Object(r.jsx)(pt.a,{variant:"body1",children:n["Connecting to peers"]()+"..."})]});var a,s=[],c=Object($.a)(t);try{for(c.s();!(a=c.n()).done;){var i=a.value;s.push(Object(r.jsx)(zr,{peer:i},i.peerCid+i.port)),s.push(Object(r.jsx)(rt.a,{},i.peerCid+i.port+"feed divider"))}}catch(o){c.e(o)}finally{c.f()}return Object(r.jsx)("div",{children:s})}var Jr=function(){var e=q(),t=Object(o.f)(),n=Ar();return console.log("Stats",{peers:n}),Object(r.jsxs)("div",{children:[Object(r.jsxs)(Mt,{children:[Object(r.jsx)(R.a,{pr:1,children:Object(r.jsx)(nt.a,{onClick:function(){return t.goBack()},children:Object(r.jsx)(Kt.a,{})})}),Object(r.jsx)(pt.a,{noWrap:!0,variant:"h6",children:e["Connected peers stats"]()})]}),Object(r.jsx)(Kr,{peers:n})]})},_r=Object(l.a)((function(e){return{avatar:{marginTop:e.spacing(-.25),width:e.spacing(6),height:e.spacing(6),borderWidth:e.sav3.borderWidth,borderStyle:"solid",borderColor:e.sav3.borderColor,backgroundColor:e.palette.background.default},userCid:{wordBreak:"break-all",textDecoration:"inherit"},displayName:{color:"inherit",textDecoration:"inherit"}}}));var Hr=function(e){return ie()("string"===typeof e,"forceHttps link '".concat(e,"' not a string")),e=(e=e.trim()).replace(/^http:\/\//,"https://")},qr=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.user,n=_r(),a=q(),s=gn(t.cid),c=Object(d.a)(s,2),i=c[0],o=c[1],u=Object(r.jsx)(F.a,{variant:"outlined",size:"small",color:"primary",onClick:function(){return o(!0)},children:a.Follow()});i&&(u=Object(r.jsx)(F.a,{variant:"outlined",size:"small",color:"primary",onClick:function(){return o(!1)},children:a.Unfollow()}));var l=Sn(t.cid),p="/profile/".concat(l);return Object(r.jsx)("div",{children:Object(r.jsxs)(R.a,{px:2,py:1.5,display:"flex",children:[Object(r.jsx)(R.a,{pr:1.5,children:Object(r.jsx)(lt.a,{component:D.b,to:p,src:t.thumbnailUrl&&Hr(t.thumbnailUrl),className:n.avatar})}),Object(r.jsxs)(R.a,{width:"100%",children:[Object(r.jsxs)(R.a,{display:"flex",children:[Object(r.jsxs)(R.a,{flexGrow:1,children:[Object(r.jsx)(R.a,{display:"flex",children:Object(r.jsx)(pt.a,{className:n.displayName,component:D.b,to:p,variant:"subtitle2",children:t.displayName})}),Object(r.jsx)(R.a,{children:Object(r.jsx)(pt.a,{component:D.b,to:p,variant:"caption",color:"textSecondary",className:n.userCid,children:t.cid})})]}),Object(r.jsx)(R.a,{height:48,children:u})]}),Object(r.jsx)(pt.a,{variant:"body2",children:t.description})]})]})})};var Vr=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.users,a=[],s=Object($.a)(n);try{for(s.s();!(e=s.n()).done;){var c=e.value;a.push(Object(r.jsx)(qr,{user:c},c.cid)),a.push(Object(r.jsx)(rt.a,{},c.cid+"feed divider"))}}catch(i){s.e(i)}finally{s.f()}return Object(r.jsx)("div",{children:a})};var Gr=function(){var e,t=q(),n=Object(o.f)(),a=jr(),s=xr(a),c=[],i=Object($.a)(a);try{for(i.s();!(e=i.n()).done;){var u=e.value,l=s[u]||{};l.cid=u,c.push(l)}}catch(p){i.e(p)}finally{i.f()}return console.log("Following",{followingCids:a,profiles:s,users:c}),Object(r.jsxs)("div",{children:[Object(r.jsxs)(Mt,{children:[Object(r.jsx)(R.a,{pr:1,children:Object(r.jsx)(nt.a,{onClick:function(){return n.goBack()},children:Object(r.jsx)(Kt.a,{})})}),Object(r.jsx)(pt.a,{noWrap:!0,variant:"h6",children:t.Following()})]}),Object(r.jsx)(Vr,{users:c})]})},Zr=function(){var e=Object(a.useContext)(vn),t=e.following,n=e.setAllFollowing;return[Object.keys(t).filter((function(e){return!!t[e]})),n]},Qr=Object(l.a)((function(e){return{message:{overflow:"hidden"},data:{"& textarea":{fontFamily:"Monospace",minHeight:"10vh",maxHeight:"40vh",overflowY:"scroll!important"},"& fieldset":{border:"none"},"& .MuiInputBase-root":{paddingLeft:0,paddingRight:0},marginBottom:e.spacing(1)}}}));var Xr=function(){var e=q(),t=Qr(),n=Object(p.a)(),s=Zr(),c=Object(d.a)(s,2)[1],i=Object(a.useState)(""),o=Object(d.a)(i,2),u=o[0],l=o[1],f=Object(a.useState)(),b=Object(d.a)(f,2),h=b[0],j=b[1],v=Object(a.useState)(),x=Object(d.a)(v,2),g=x[0],O=x[1],m=function(e){try{e.target.setSelectionRange(0,e.target.value.length)}catch(t){}},y=function(){var e=Object(Z.a)(G.a.mark((function e(){var t,n,r;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l("Exporting..."),j(null),O(null),e.prev=3,e.next=6,jn.getAllFollowing();case 6:return t=e.sent,e.next=9,Qe.getPrivateKey();case 9:n=e.sent,console.log({privateKey:n}),r=JSON.stringify({privateKey:n,following:t}),j(null),l(r),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(3),j(e.t0.message);case 19:O("Export successful. Copy paste your data somewhere safe.");case 20:case"end":return e.stop()}}),e,null,[[3,16]])})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(Z.a)(G.a.mark((function e(){var t,n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:j(null),O(null),e.prev=2,t=JSON.parse(u),e.next=10;break;case 6:return e.prev=6,e.t0=e.catch(2),j("Invalid JSON: ".concat(e.t0.message)),e.abrupt("return");case 10:if(h===(n="Did you backup your data? Importing will irreversibly delete it. Click import again to confirm.")){e.next=14;break}return j(n),e.abrupt("return");case 14:return e.prev=14,e.next=17,jn.setAllFollowing(t.following);case 17:c(t.following),e.next=24;break;case 20:return e.prev=20,e.t1=e.catch(14),j("Invalid following: ".concat(e.t1.message)),e.abrupt("return");case 24:return e.prev=24,e.next=27,jn.setAllFollowing(t.following);case 27:c(t.following),e.next=34;break;case 30:return e.prev=30,e.t2=e.catch(24),j("Invalid privateKey: ".concat(e.t2.message)),e.abrupt("return");case 34:j(null),O("Import successful.");case 36:case"end":return e.stop()}}),e,null,[[2,6],[14,20],[24,30]])})));return function(){return e.apply(this,arguments)}}(),C=Object(r.jsxs)("div",{children:[Object(r.jsx)(R.a,{children:Object(r.jsx)(rt.a,{})}),Object(r.jsxs)(R.a,{alignItems:"center",display:"flex",height:n.sav3.topBar.height,children:[Object(r.jsx)(R.a,{flexGrow:1}),Object(r.jsx)(F.a,{disableElevation:!0,variant:"contained",onClick:w,color:"primary",children:e.Import()}),Object(r.jsx)(R.a,{pr:.5}),Object(r.jsx)(F.a,{disableElevation:!0,variant:"contained",onClick:y,color:"primary",children:e.Export()})]})]});return Object(r.jsx)(R.a,{px:2,display:"flex",children:Object(r.jsxs)(R.a,{pt:0,width:"100%",children:[Object(r.jsx)(Q.a,{onClick:m,onFocus:m,className:t.data,onChange:function(e){var t=e.target.value;l(t)},margin:"dense",id:"data",placeholder:"Paste exported data here...",fullWidth:!0,multiline:!0,variant:"outlined",value:u}),h&&Object(r.jsx)(R.a,{pb:1,children:Object(r.jsx)(Xe.a,{classes:{message:t.message},severity:"error",children:h})}),g&&Object(r.jsx)(R.a,{pb:1,children:Object(r.jsx)(Xe.a,{classes:{message:t.message},severity:"success",children:g})}),Object(r.jsx)(R.a,{pb:0}),C]})})};var $r=function(){var e=Object(p.a)(),t=Object(at.a)(e.breakpoints.down("xs")),n=q();return Object(r.jsxs)("div",{children:[Object(r.jsxs)(Mt,{children:[t&&Object(r.jsx)(R.a,{pl:2,pr:1,children:Object(r.jsx)(hr,{})}),Object(r.jsx)(R.a,{pl:2,children:Object(r.jsxs)(pt.a,{noWrap:!0,variant:"h6",children:[n.Import()," / ",n.Export()]})})]}),Object(r.jsx)(Xr,{})]})},Yr=function(e){ie()(Array.isArray(e),"invalid postCids '".concat(JSON.stringify(e),"'"));var t=Object(a.useState)({}),n=Object(d.a)(t,2),r=n[0],s=n[1];return console.log("usePosts",{postCids:e,posts:r}),Object(a.useEffect)((function(){if(e.length){var t,n=Object($.a)(e);try{var r=function(){var e=t.value;if(!e||"string"!==typeof e)return"continue";Qe.getPost(e).then((function(t){s((function(n){return Object(X.a)(Object(X.a)({},n),{},Object(i.a)({},e,t))}))}))};for(n.s();!(t=n.n()).done;)r()}catch(a){n.e(a)}finally{n.f()}}}),[JSON.stringify(e)]),r},ea=function(e){ie()(!e||"string"===typeof e,"invalid postCid '".concat(JSON.stringify(e),"'"));var t=Object(a.useState)(),n=Object(d.a)(t,2),r=n[0],s=n[1],c=Rn(r&&r.cid),i=Yr(c);if(Object(a.useEffect)((function(){e&&"string"===typeof e?Object(Z.a)(G.a.mark((function t(){var n,r;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Qe.getPost(e);case 2:if(n=t.sent,r=n,!n.parentPostCid){t.next=8;break}return t.next=7,Qe.getPost(n.parentPostCid);case 7:r=t.sent;case 8:s(r);case 9:case"end":return t.stop()}}),t)})))():s()}),[e]),console.log("usePostWithReplies",{parentPost:r,repliesCids:c,replies:i}),r)return Object(X.a)(Object(X.a)({},r),{},{replies:i})};var ta=function(){var e,t=Object(o.h)().encodedCid,n=t&&In(t);!n&&t&&(e=kn(t));var a=ea(e),s=Object(o.f)(),c=q(),i=[];if(a)for(var u in i.push(a),a.replies)i.push(a.replies[u]);for(var l=new Set,p=0,d=i;p<d.length;p++){var f=d[p];l.add(f.userCid)}for(var b=xr(Object(ur.a)(l)),h=0,j=i;h<j.length;h++){var v=j[h];v.profile=b[v.userCid]||{}}var x=Object(r.jsx)(Vn,{posts:i});return i.length||(x=Object(r.jsxs)(R.a,{width:"100%",py:4,display:"flex",justifyContent:"center",alignItems:"center",children:[Object(r.jsx)(yr.a,{size:24}),Object(r.jsx)(R.a,{p:.5}),Object(r.jsx)(pt.a,{variant:"body1",children:c["Connecting to peers"]()+"..."})]})),n&&(x=Object(r.jsx)(R.a,{width:"100%",py:4,display:"flex",justifyContent:"center",alignItems:"center",children:Object(r.jsx)(pt.a,{variant:"body1",children:c["URL expired"]()+"."})})),console.log("Post",{postCid:e,postWithReplies:a,posts:i}),Object(r.jsxs)("div",{children:[Object(r.jsxs)(Mt,{children:[Object(r.jsx)(R.a,{pr:1,children:Object(r.jsx)(nt.a,{onClick:function(){return s.goBack()},children:Object(r.jsx)(Kt.a,{})})}),Object(r.jsx)(pt.a,{noWrap:!0,variant:"h6",children:c.Post()})]}),x]})},na=Object(l.a)((function(e){var t,n,r;return{leftColumn:(t={overflow:"hidden"},Object(i.a)(t,e.breakpoints.down("xs"),{display:"none"}),Object(i.a)(t,e.breakpoints.down("md"),{width:e.sav3.layout.columns.left.width.xs}),Object(i.a)(t,e.breakpoints.down("lg"),{width:e.sav3.layout.columns.left.width.xs}),Object(i.a)(t,e.breakpoints.up("lg"),{width:e.sav3.layout.columns.left.width.md}),t),middleColumn:(n={overflow:"hidden"},Object(i.a)(n,e.breakpoints.down("xs"),{width:"100%"}),Object(i.a)(n,e.breakpoints.up("xs"),{width:e.sav3.layout.columns.middle.width.md}),Object(i.a)(n,"borderLeftWidth",e.sav3.borderWidth),Object(i.a)(n,"borderRightWidth",e.sav3.borderWidth),Object(i.a)(n,"borderTopWidth",0),Object(i.a)(n,"borderBottomWidth",0),Object(i.a)(n,"borderStyle","solid"),Object(i.a)(n,"borderColor",e.sav3.borderColor),n),rightColumn:(r={overflow:"hidden"},Object(i.a)(r,e.breakpoints.down("sm"),{display:"none"}),Object(i.a)(r,e.breakpoints.down("lg"),{width:e.sav3.layout.columns.right.width.md,paddingLeft:e.spacing(3),paddingRight:e.spacing(3)}),Object(i.a)(r,e.breakpoints.up("lg"),{width:e.sav3.layout.columns.right.width.lg,paddingLeft:e.spacing(4),paddingRight:e.spacing(4)}),r),bottomMenu:Object(i.a)({},e.breakpoints.up("sm"),{display:"none"}),appBar:{backgroundColor:e.palette.background.default}}}));var ra=function(){var e=na(),t=Object(p.a)();return window.theme=t,Object(r.jsxs)("div",{children:[Object(r.jsxs)(u.a,{container:!0,justify:"center",children:[Object(r.jsx)(u.a,{item:!0,className:e.leftColumn,children:Object(r.jsx)(vt,{})}),Object(r.jsx)(u.a,{item:!0,className:e.middleColumn,children:Object(r.jsxs)(o.c,{children:[Object(r.jsx)(o.a,{path:"/",exact:!0,children:Object(r.jsx)(wr,{})}),Object(r.jsx)(o.a,{path:"/profile/:encodedCid?",exact:!0,children:Object(r.jsx)(or,{})}),Object(r.jsx)(o.a,{path:"/search",exact:!0,children:Object(r.jsx)(Pr,{})}),Object(r.jsx)(o.a,{path:"/peers",exact:!0,children:Object(r.jsx)(Rr,{})}),Object(r.jsx)(o.a,{path:"/stats",exact:!0,children:Object(r.jsx)(Jr,{})}),Object(r.jsx)(o.a,{path:"/following",exact:!0,children:Object(r.jsx)(Gr,{})}),Object(r.jsx)(o.a,{path:"/export",exact:!0,children:Object(r.jsx)($r,{})}),Object(r.jsx)(o.a,{path:"/post/:encodedCid",exact:!0,children:Object(r.jsx)(ta,{})})]})}),Object(r.jsxs)(u.a,{item:!0,className:e.rightColumn,children:[Object(r.jsx)(Tt,{}),Object(r.jsx)(Wt,{})]})]}),Object(r.jsx)(yt,{className:e.bottomMenu})]})},aa=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,1369)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,s=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),s(e),c(e)}))},sa=n(1358);c.a.render(Object(r.jsx)(D.a,{children:Object(r.jsx)(Bt,{children:Object(r.jsx)(H,{children:Object(r.jsxs)(xn,{children:[Object(r.jsx)(sa.a,{}),Object(r.jsx)(ra,{})]})})})}),document.getElementById("root")),aa()},167:function(e,t,n){"use strict";var r={starServers:["/dns4/star.sav3.org/tcp/443/wss/p2p-webrtc-star/"],ipnsServer:"https://ipns.sav3.org",urlTimeToLive:864e5};window.config=r,t.a=r},276:function(e,t){},331:function(e,t){},545:function(e,t,n){"use strict";(function(e){var r=n(355),a=n(28),s=n(1),c=n.n(s),i=n(8),o=n(120),u=n(93),l=n(241),p=n(257),d=n(11),f=n.n(d),b=n(351),h=n.n(b),j=n(40),v=n.n(j),x=n(82),g=n.n(x),O=n(53),m=n.n(O),y=n(166),w=n.n(y),C=n(29),k=n.n(C),S=n(26),I=n.n(S),P=n(91),F=n.n(P),R=n(244),N=n.n(R),B=n(167),U=function(t){Object(l.a)(r,t);var n=Object(p.a)(r);function r(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=t.ipfs;return Object(o.a)(this,r),e=n.call(this),f()(a&&"object"===typeof a),e.ipfs=a,e.privateKey=null,e.webSocketClient=null,e.peerCid=null,e.url=B.a.ipnsServer,e.subscriptionIpnsValueCache=new N.a({maxSize:1e4}),e.start(),e}return Object(u.a)(r,[{key:"start",value:function(){var e=Object(i.a)(c.a.mark((function e(){var t,n=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f()(null===this.webSocketClient),this.webSocketClient=h()(this.url),e.next=4,this.ipfs.key.export("self","password");case 4:return t=e.sent,e.next=7,g.a.keys.import(t,"password");case 7:return this.privateKey=e.sent,e.next=10,this.ipfs.id();case 10:this.peerCid=e.sent.id,this.webSocketClient.on("publish",function(){var e=Object(i.a)(c.a.mark((function e(t,r){var a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,W(t,r);case 2:a=e.sent,n.subscriptionIpnsValueCache.set(t,a),n.emit("publish",t,a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}());case 12:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"stop",value:function(){var e=Object(i.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.webSocketClient.close();case 2:this.webSocketClient=null;case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"isReady",value:function(){return this.webSocketClient&&this.privateKey}},{key:"waitForReady",value:function(){var e=Object(i.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isReady()){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,w()(10);case 4:return e.next=6,this.waitForReady();case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"subscribe",value:function(){var e=Object(i.a)(c.a.mark((function e(t){var n,r,s,i,o,u,l,p,d,f=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(t),e.next=3,this.waitForReady();case 3:n=!0,r=[],s=Object(a.a)(t);try{for(s.s();!(i=s.n()).done;)o=i.value,u=this.subscriptionIpnsValueCache.get(o),r.push(u),u||(n=!1)}catch(c){s.e(c)}finally{s.f()}if(!n){e.next=10;break}return console.log("ipns.subscribe",{allResultsAreCached:n,ipnsPaths:t,cachedIpnsValues:r}),e.abrupt("return",r);case 10:return e.next=12,new Promise((function(e){return f.webSocketClient.emit("subscribe",t,e)}));case 12:return l=e.sent,e.next=15,T(t,l);case 15:for(d in p=e.sent,t)this.subscriptionIpnsValueCache.set(t[d],p[d]);return console.log("ipns.subscribe",{allResultsAreCached:n,ipnsPaths:t,ipnsValues:p}),e.abrupt("return",p);case 19:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getRecords",value:function(){var e=Object(i.a)(c.a.mark((function e(t){var n,r,a=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(t),e.next=3,this.waitForReady();case 3:return e.next=5,new Promise((function(e){return a.webSocketClient.emit("resolve",t,e)}));case 5:return n=e.sent,e.next=8,A(t,n);case 8:return r=e.sent,e.abrupt("return",r);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"unsubscribe",value:function(){var e=Object(i.a)(c.a.mark((function e(t){var n,r,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return D(t),e.next=3,this.waitForReady();case 3:n=Object(a.a)(t);try{for(n.s();!(r=n.n()).done;)s=r.value,this.subscriptionIpnsValueCache.delete(s)}catch(c){n.e(c)}finally{n.f()}return e.next=7,this.webSocketClient.emit("unsubscribe",t);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"publish",value:function(){var t=Object(i.a)(c.a.mark((function t(){var n,r,a,s,i,o,u,l=arguments;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=l.length>0&&void 0!==l[0]?l[0]:{},r=n.value,a=n.sequence,f()("string"===typeof r),f()("number"===typeof a),t.next=5,this.waitForReady();case 5:return r.startsWith("/ipfs/")||(r="/ipfs/".concat(r)),s=31536e7,t.next=9,m.a.create(this.privateKey,r,a,s);case 9:return i=t.sent,t.next=12,m.a.embedPublicKey(this.privateKey.public,i);case 12:return o=e.from(m.a.marshal(i)),u=this.peerCid,t.next=16,this.webSocketClient.emit("publish",u,o);case 16:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()}]),r}(v.a),D=function(e){f()(Array.isArray(e),"ipns paths '".concat(e,"' not an array"));var t,n=Object(a.a)(e);try{for(n.s();!(t=n.n()).done;){var r=t.value;f()("string"===typeof r,"ipns paths '".concat(e,"' contains non string '").concat(r,"'"))}}catch(s){n.e(s)}finally{n.f()}},T=function(){var e=Object(i.a)(c.a.mark((function e(t,n){var r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f()(Array.isArray(t)),f()(Array.isArray(n)),r=[],e.t0=c.a.keys(t);case 4:if((e.t1=e.t0()).done){e.next=16;break}if(a=e.t1.value,null!==n[a]){e.next=9;break}return r.push(null),e.abrupt("continue",4);case 9:return e.t2=r,e.next=12,W(t[a],n[a]);case 12:e.t3=e.sent,e.t2.push.call(e.t2,e.t3),e.next=4;break;case 16:return e.abrupt("return",r);case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),W=function(){var e=Object(i.a)(c.a.mark((function e(t,n){var r,a,s,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f()("string"===typeof t),n=new Uint8Array(n),r=m.a.unmarshal(n),a=m.a.extractPublicKey({},r),e.next=6,m.a.validate(a,r);case 6:return e.next=8,I.a.createFromPubKey(a.bytes);case 8:return s=e.sent,f()(s.equals(I.a.createFromB58String(t))),i=k()(r.value),f()(F.a.cid(i.replace(/^\/ipfs\//,""))),e.abrupt("return",i);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),A=function(){var e=Object(i.a)(c.a.mark((function e(t,n){var r,a;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:f()(Array.isArray(t)),f()(Array.isArray(n)),r=[],e.t0=c.a.keys(t);case 4:if((e.t1=e.t0()).done){e.next=16;break}if(a=e.t1.value,null!==n[a]){e.next=9;break}return r.push(null),e.abrupt("continue",4);case 9:return e.t2=r,e.next=12,E(t[a],n[a]);case 12:e.t3=e.sent,e.t2.push.call(e.t2,e.t3),e.next=4;break;case 16:return e.abrupt("return",r);case 17:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),E=function(){var e=Object(i.a)(c.a.mark((function e(t,n){var r,a,s,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f()("string"===typeof t),n=new Uint8Array(n),r=m.a.unmarshal(n),a=m.a.extractPublicKey({},r),e.next=6,m.a.validate(a,r);case 6:return e.next=8,I.a.createFromPubKey(a.bytes);case 8:return s=e.sent,f()(s.equals(I.a.createFromB58String(t))),i=k()(r.value),f()(F.a.cid(i.replace(/^\/ipfs\//,""))),e.abrupt("return",r);case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();window.IpnsClient=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Object(r.a)(U,t)},window.ipns=m.a,t.a=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Object(r.a)(U,t)}}).call(this,n(24).Buffer)},585:function(e,t){},592:function(e,t){},666:function(e,t){},667:function(e,t){},767:function(e,t){},769:function(e,t){},825:function(e,t){},887:function(e,t){},889:function(e,t){},983:function(e,t){}},[[1292,1,2]]]);
//# sourceMappingURL=main.bf490c09.chunk.js.map